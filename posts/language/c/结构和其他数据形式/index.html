<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>结构和其他数据形式 - xcx</title><meta name="description" content=""><meta property="og:title" content="结构和其他数据形式" />
<meta property="og:description" content="结构和其他数据形式 C 语言中，提供结构变量 可以提高表示数据的能力，创造新的形式。 1 示例问题：创建图书目录 打印图书目录，包括：书名、作者、价格。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiechaoxin.github.io/posts/language/c/%E7%BB%93%E6%9E%84%E5%92%8C%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BD%A2%E5%BC%8F/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-12T04:32:14+00:00" />
<meta property="article:modified_time" content="2022-09-12T04:32:14+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="结构和其他数据形式"/>
<meta name="twitter:description" content="结构和其他数据形式 C 语言中，提供结构变量 可以提高表示数据的能力，创造新的形式。 1 示例问题：创建图书目录 打印图书目录，包括：书名、作者、价格。"/>
<meta name="application-name" content="xcx">
<meta name="apple-mobile-web-app-title" content="xcx"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://xiechaoxin.github.io/posts/language/c/%E7%BB%93%E6%9E%84%E5%92%8C%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BD%A2%E5%BC%8F/" /><link rel="prev" href="https://xiechaoxin.github.io/posts/language/c/c_cpp%E8%AF%AD%E8%A8%80%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/" /><link rel="next" href="https://xiechaoxin.github.io/posts/language/c/%E4%BD%8D%E6%93%8D%E4%BD%9C/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "结构和其他数据形式",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/xiechaoxin.github.io\/posts\/language\/c\/%E7%BB%93%E6%9E%84%E5%92%8C%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BD%A2%E5%BC%8F\/"
        },"genre": "posts","keywords": "C","wordcount":  5133 ,
        "url": "https:\/\/xiechaoxin.github.io\/posts\/language\/c\/%E7%BB%93%E6%9E%84%E5%92%8C%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BD%A2%E5%BC%8F\/","datePublished": "2022-09-12T04:32:14+00:00","dateModified": "2022-09-12T04:32:14+00:00","publisher": {
            "@type": "Organization",
            "name": "作者"},"author": {
                "@type": "Person",
                "name": "作者"
            },"description": ""
    }
    </script></head><body data-header-desktop="" data-header-mobile=""><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="xcx">xcx</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="在客户端搜索可能比较慢~" id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" onclick="return false;" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="xcx">xcx</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="在客户端搜索可能比较慢~" id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><div class="menu-item"><a href="#" onclick="return false;" class="theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="single-card" ><h2 class="single-title animated flipInX">结构和其他数据形式</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>作者</a></span>&nbsp;<span class="post-category">出版于  <a href="/categories/c/"><i class="far fa-folder fa-fw"></i>C</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-09-12">2022-09-12</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 5133 字</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 11 分钟</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>目录</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-示例问题创建图书目录">1 示例问题：创建图书目录</a></li>
    <li><a href="#2-建立结构声明">2 建立结构声明</a></li>
    <li><a href="#3-定义结构变量">3 定义结构变量</a>
      <ul>
        <li><a href="#31-初始化结构">3.1 初始化结构</a></li>
        <li><a href="#32-访问结构成员">3.2 访问结构成员</a></li>
        <li><a href="#33-结构的初始化器">3.3 结构的初始化器</a></li>
      </ul>
    </li>
    <li><a href="#4-结构数组">4 结构数组</a>
      <ul>
        <li><a href="#41-声明结构数组">4.1 声明结构数组</a></li>
        <li><a href="#42-标识结构数组的成员">4.2 标识结构数组的成员</a></li>
        <li><a href="#43-嵌套结构">4.3 嵌套结构</a></li>
      </ul>
    </li>
    <li><a href="#5-指向结构的指针">5 指向结构的指针</a>
      <ul>
        <li><a href="#51-声明和初始化结构指针">5.1 声明和初始化结构指针</a></li>
        <li><a href="#52-用指针访问成员">5.2 用指针访问成员</a></li>
      </ul>
    </li>
    <li><a href="#6-向函数传递结构的信息">6 向函数传递结构的信息</a>
      <ul>
        <li><a href="#61-传递结构成员">6.1 传递结构成员</a></li>
      </ul>
    </li>
    <li><a href="#7-传递结构的地址">7 传递结构的地址</a></li>
    <li><a href="#8-传递结构">8 传递结构</a></li>
    <li><a href="#9-其他结构特性">9 其他结构特性</a></li>
    <li><a href="#10-结构和结构指针的选择">10 结构和结构指针的选择</a>
      <ul>
        <li><a href="#101-结构中的字符数组和字符指针">10.1 结构中的字符数组和字符指针</a></li>
        <li><a href="#102-结构指针和malloc">10.2 结构、指针和<code>malloc()</code></a></li>
        <li><a href="#103-复合字面量和结构c99">10.3 复合字面量和结构(C99)</a></li>
        <li><a href="#104-伸缩型数组成员c99">10.4 伸缩型数组成员(C99)</a></li>
        <li><a href="#105-匿名结构c11">10.5 匿名结构(C11)</a></li>
      </ul>
    </li>
    <li><a href="#11-联合简介">11 联合简介</a>
      <ul>
        <li><a href="#111-使用联合">11.1 使用联合</a></li>
      </ul>
    </li>
    <li><a href="#12-枚举类型">12 枚举类型</a>
      <ul>
        <li><a href="#121-枚举-enum-的用法">12.1 枚举 enum 的用法</a></li>
      </ul>
    </li>
    <li><a href="#13-typedef-简介">13 typedef 简介</a>
      <ul>
        <li><a href="#131-typedef-和-define-的区别">13.1 <code>typedef</code> 和 <code>define</code> 的区别</a></li>
        <li><a href="#132-使用-typedef-的原因">13.2 使用 typedef 的原因</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="结构和其他数据形式">结构和其他数据形式</h1>
<p>C 语言中，提供结构变量 可以提高表示数据的能力，创造新的形式。</p>
<h2 id="1-示例问题创建图书目录">1 示例问题：创建图书目录</h2>
<p>打印图书目录，包括：书名、作者、价格。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp"># include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># include &lt;string.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="o">*</span><span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp"># define MAXTITL 41; </span><span class="c1">// 书名最大长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp"># define MAX AUTL 31; </span><span class="c1">// 作者名字的最大长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">book</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">title</span><span class="p">[</span><span class="n">MAXTITL</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">author</span><span class="p">[</span><span class="n">MAXAUTL</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span><span class="c1">//结构模版结束
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">book</span> <span class="n">library</span><span class="p">;</span> <span class="c1">// 把library声明为一个book类型的变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please enter the book title.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">s_gets</span><span class="p">(</span><span class="n">library</span><span class="p">.</span><span class="n">title</span><span class="p">,</span> <span class="n">MAXTITL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Now enter the author.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">s_gets</span><span class="p">(</span><span class="n">library</span><span class="p">.</span><span class="n">author</span><span class="p">,</span> <span class="n">MAXAUTL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Now enter the value.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%f&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">library</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s by %s: $%.2f</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">title</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">author</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s: </span><span class="se">\&#34;</span><span class="s">%s</span><span class="se">\&#34;</span><span class="s">($%.2f)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">author</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">title</span><span class="p">,</span> <span class="n">library</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Done.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="o">*</span> <span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="n">find</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">ret_val</span> <span class="o">=</span> <span class="nf">fgets</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">find</span> <span class="o">=</span> <span class="nf">strchr</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="sc">&#39;\n&#39;</span><span class="p">);</span><span class="c1">//查找换行符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">if</span> <span class="p">(</span><span class="n">find</span><span class="p">)</span>              <span class="c1">//如果地址不是NULL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="o">*</span><span class="n">find</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="c1">//将换行符换成&#39;\0&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			<span class="k">while</span> <span class="p">(</span><span class="nf">getchar</span><span class="p">()</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>  <span class="c1">//处理输入行剩余的字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>				<span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>结构的 3 个技巧</p>
<blockquote>
<ul>
<li>为结构建立一个格式或样式。</li>
<li>声明一个适合该样式的变量。</li>
<li>访问结构变量的各个部分。</li>
</ul>
</blockquote>
<h2 id="2-建立结构声明">2 建立结构声明</h2>
<ul>
<li>
<p><code>结构声明(structure declaration)</code>描述了一个结构的组织布局。</p>
</li>
<li>
<p>在结构声明，用<code>一对花括号</code>括起来的是<code>结构成员列表</code>。每个成员都可以是任意一种 C 的数据类型。</p>
</li>
<li>
<p>右花括号后面的分号是声明必需，表示结构布局定义结束。</p>
</li>
<li>
<p>结构声明可以放在所有函数的外部，也可以放在一个函数定义的内部，但是如果把声明放在函数内部，它的标记只局限于该函数内部使用。</p>
</li>
<li>
<p>结构的标记名是可选的，但是在一处定义结构布局，在另一处定义实际的结构变量，必须使用标记。</p>
</li>
</ul>
<h2 id="3-定义结构变量">3 定义结构变量</h2>
<p>结构的含义：</p>
<blockquote>
<ul>
<li>
<p>结构布局告诉编译器如何表示数据，但不让编译器为数据分配空间。</p>
</li>
<li>
<p>创建另一个结构变量。</p>
</li>
</ul>
</blockquote>
<h3 id="31-初始化结构">3.1 初始化结构</h3>
<p>让每个成员的初始化项独占一行。目的：提高代码的可读性，对编译器而言，只需要用逗号分隔各成员的初始化项。</p>
<ul>
<li>
<p>初始化一个结构变量(ANSI 之前，不能自动变量初始化结构，ANSI 之后可以用任意存储类别)与初始化数组的语法类似。</p>
</li>
<li>
<p>使用在一对花括号中括起来的初始化列表进行初始化，各初始化项用逗号分隔。</p>
</li>
</ul>
<p><strong>⚠️ 注意：初始化结构和类别存储期</strong></p>
<ul>
<li>
<p>如果初始化一个静态存储期的结构，初始化列表中的值必须是常量表达式。</p>
</li>
<li>
<p>如果是自动存储期，初始化列表中的值可以不是常量。</p>
</li>
</ul>
<h3 id="32-访问结构成员">3.2 访问结构成员</h3>
<ul>
<li>使用结构成员运算符 ————&gt; <code>点(.)</code> 访问结构中的成员。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/*访问library中的title部分*/</span>
</span></span><span class="line"><span class="cl"><span class="n">library</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;C Primer Plus&#34;</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li><code>点(.)</code> 比 <code>地址符(&amp;)</code> 优先级高。</li>
</ul>
<h3 id="33-结构的初始化器">3.3 结构的初始化器</h3>
<ul>
<li>C99 和 C11 为结构提供了指定<code>初始化器(也叫标记化结构初始化语法)</code>，结构的指定初始化器使用<code>点运算符</code>和<code>成员名(而不是方括号和下标)标识</code>特定的元素。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">book</span> <span class="n">gift</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="p">.</span><span class="n">price</span> <span class="o">=</span> <span class="mf">69.00</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">.</span><span class="n">author</span> <span class="o">=</span> <span class="s">&#34;Stephen Prata&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;c primer plus&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><ul>
<li>
<p>在指定初始化器后面的<code>普通初始化器</code>，为指定成员后面的成员提供初始值。</p>
</li>
<li>
<p>指定成员的最后一次赋值才是它实际获得的值。</p>
</li>
</ul>
<h2 id="4-结构数组">4 结构数组</h2>
<h3 id="41-声明结构数组">4.1 声明结构数组</h3>
<p>声明结构数组和声明其他类型的数组类似。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/*把library声明为一个内含MAXBKS个元素的数组*/</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">book</span> <span class="n">library</span><span class="p">[</span><span class="n">MAXBKS</span><span class="p">];</span>
</span></span></code></pre></div><blockquote>
<p>数组名 library 不是结构名，是数组名。数组中的每个元素都是 struct book 类型的结构变量。</p>
</blockquote>
<h3 id="42-标识结构数组的成员">4.2 标识结构数组的成员</h3>
<p>为了表示结构数组中的成员，采用访问单独结构的规则：在结构名后面加一个点运算符，再在点运算符后面加上成员名。如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">library</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">price</span>  <span class="cm">/*第1个数组元素与price相关联*/</span>
</span></span><span class="line"><span class="cl"><span class="n">library</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">title</span>  <span class="cm">/*第5个数组元素与title相关联*/</span>
</span></span></code></pre></div><blockquote>
<p>⚠️ 注意：<strong><em>数组下标紧跟在数组名(如 library 后面)，不是成员名后面。</em></strong></p>
</blockquote>
<h3 id="43-嵌套结构">4.3 嵌套结构</h3>
<p>嵌套结构：在一个结构中包含另一个结构。
如果访问嵌套结构的成员，需要使用两次点运算符。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp"># define _CRT_SECURE_NO_WARNINGS
</span></span></span><span class="line"><span class="cl"><span class="cp"># include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># define LEN 20
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34; Thank you for the wonderful evening, &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;You certainly prove that a &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;is a special kind of guy. We must get together&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;over a delicious &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34; and have a few laughs&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">names</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">first</span><span class="p">[</span><span class="n">LEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">last</span><span class="p">[</span><span class="n">LEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">guy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">names</span> <span class="n">handle</span><span class="p">;</span>  <span class="c1">//嵌套结构，结构里包含另一个结构
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">char</span> <span class="n">favfood</span><span class="p">[</span><span class="n">LEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">job</span><span class="p">[</span><span class="n">LEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">float</span> <span class="n">income</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">guy</span> <span class="n">fellow</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span><span class="s">&#34;Ewen&#34;</span><span class="p">,</span> <span class="s">&#34;Villard&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;grilled salmon&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;personality coach&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">68112.00</span>
</span></span><span class="line"><span class="cl">	<span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Dear %s,</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">fellow</span><span class="p">.</span><span class="n">handle</span><span class="p">.</span><span class="n">first</span><span class="p">);</span> <span class="c1">//使用嵌套结构，先使用.得到name，再.得到first
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s%s.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fellow</span><span class="p">.</span><span class="n">handle</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fellow</span><span class="p">.</span><span class="n">job</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s%s%s&#34;</span><span class="p">,</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">fellow</span><span class="p">.</span><span class="n">favfood</span><span class="p">,</span> <span class="n">msgs</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">fellow</span><span class="p">.</span><span class="n">income</span> <span class="o">&gt;</span> <span class="mf">150000.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">puts</span><span class="p">(</span><span class="s">&#34;!!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fellow</span><span class="p">.</span><span class="n">income</span> <span class="o">&gt;</span> <span class="mf">75000.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">puts</span><span class="p">(</span><span class="s">&#34;!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="n">puts</span><span class="p">(</span><span class="s">&#34;.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">%40s%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">,</span> <span class="s">&#34;See you soon,&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%40s%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">,</span> <span class="s">&#34;Shalala&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="5-指向结构的指针">5 指向结构的指针</h2>
<p>使用指向结构的指针的理由：</p>
<ul>
<li>指向结构的指针通常是结构本身更容易操控(指向数组的指针比数组本身更容易操控)。</li>
<li>早期 C 实现，结构不能作为参数传递给函数，可以传递指向结构的指针。</li>
<li>能传递一个结构，传递指针通常更有效率。</li>
<li>一些用于表示数据的结构中包含指向其它结构的指针。</li>
</ul>
<h3 id="51-声明和初始化结构指针">5.1 声明和初始化结构指针</h3>
<p>例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">guy</span> <span class="o">*</span><span class="n">him</span><span class="p">;</span>
</span></span></code></pre></div><p>与数组不同的是，<del>结构名并不是结构的地址</del>，因此在结构名前加上<code>&amp;运算符</code>。</p>
<h3 id="52-用指针访问成员">5.2 用指针访问成员</h3>
<p>两种方式：</p>
<ul>
<li>
<p>使用 <code>-&gt;</code> 运算符</p>
<ul>
<li>如果 him==&amp;barney ,那么 him-&gt;income 即是 barney.income</li>
<li>如果 him==&amp;fellow[0] , 那么 him-&gt;income 即是 fellow [0].income</li>
</ul>
</li>
<li>
<p>用<code>运算符</code>(必须使用<code>圆括号</code>，因为<code>(.)运算符</code>比<code>(*)</code>运算符的优先级高)。</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">barney</span><span class="p">.</span><span class="n">income</span> <span class="o">==</span> <span class="p">(</span><span class="o">*</span><span class="n">him</span><span class="p">)</span> <span class="p">.</span> <span class="n">income</span> <span class="o">==</span> <span class="n">him</span><span class="o">-&gt;</span><span class="n">income</span> <span class="c1">//假设him== &amp;barney
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">fellow</span> <span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">income</span> <span class="o">==</span> <span class="p">(</span><span class="o">*</span><span class="n">him</span><span class="p">)</span> <span class="p">.</span><span class="n">income</span>
</span></span></code></pre></div><p>有些系统，<strong>一个结构的大小可能大于它各成员大小之和</strong>。</p>
<h2 id="6-向函数传递结构的信息">6 向函数传递结构的信息</h2>
<p>函数的参数把值(都是数字&mdash;&gt; int 类型，float 类型、ASCII 字符码、地址)传递给函数。</p>
<h3 id="61-传递结构成员">6.1 传递结构成员</h3>
<p>只要结构成员是一个具有单个值的数据类型(即 int 及其相关类型、char、float、double 或指针)，可作为参数传递给接受该特定类型的函数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/*把结构成员作为参数传递*/</span>
</span></span><span class="line"><span class="cl"><span class="cp"># include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># define FUNDLEN 50
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">funds</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span>   <span class="n">bank</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">bankfund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span>   <span class="n">save</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">savefund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span> <span class="kt">double</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">funds</span> <span class="n">stan</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Garlic-Melon Bank&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">4032.27</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Lucky&#39;s Savings and Loan&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">8543.94</span>
</span></span><span class="line"><span class="cl">	<span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Stan has a total of $%.2f.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span><span class="p">(</span><span class="n">stan</span><span class="p">.</span><span class="n">bankfund</span><span class="p">,</span> <span class="n">stan</span><span class="p">.</span><span class="n">savefund</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* adds two double numbers */</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="kt">double</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="7-传递结构的地址">7 传递结构的地址</h2>
<p>必须使用<code>&amp;运算符</code>来获取<code>结构的地址</code>，结构名只是其地址的别名。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp"># include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># define FUNDLEN 50
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">funds</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">bank</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">bankfund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">save</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">savefund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">funds</span> <span class="o">*</span><span class="p">);</span> <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">funds</span> <span class="n">stan</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Garlic--Melon Bank&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">4032.27</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Lucky&#39;s Savings and Loan&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">8543.94</span>
</span></span><span class="line"><span class="cl">	<span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Stan has a total of $%.2f.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">sum</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stan</span><span class="p">));</span> <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">funds</span> <span class="o">*</span> <span class="n">money</span><span class="p">)</span> <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">(</span><span class="n">money</span><span class="o">-&gt;</span><span class="n">bankfund</span> <span class="o">+</span> <span class="n">money</span><span class="o">-&gt;</span><span class="n">savefund</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="8-传递结构">8 传递结构</h2>
<p>把结构作为参数的编译器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp"># include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># define FUNDLEN 50
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">funds</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">bank</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">bankfund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">save</span><span class="p">[</span><span class="n">FUNDLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">savefund</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span> <span class="k">struct</span> <span class="nc">funds</span> <span class="n">moolah</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">funds</span> <span class="n">stan</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Garlic--Melon Bank&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">4032.27</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Lucky&#39;s Savings and Loan&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mf">8543.94</span>
</span></span><span class="line"><span class="cl">	<span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Stan has a total of $%.2f.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">sum</span><span class="p">(</span><span class="n">stan</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/*编译器会为funds结构创建一个名为moolah的自动结构变量副本，然后对副本进行操作(不会改变实际参数stan)*/</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="nf">sum</span><span class="p">(</span> <span class="k">struct</span> <span class="nc">funds</span> <span class="n">moolah</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="cm">/*类似给结构起个别名，然后通过别名来对其进行访问*/</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span><span class="p">(</span> <span class="n">moolah</span><span class="p">.</span><span class="n">bankfund</span> <span class="o">+</span> <span class="n">moolah</span><span class="p">.</span><span class="n">savefund</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="9-其他结构特性">9 其他结构特性</h2>
<ul>
<li>
<p>新标准的 C 允许把一个结构赋值给另一个结构，但数组不行。即使成员是数组，也能完成赋值。</p>
</li>
<li>
<p>现在的 C(包括 ANSI C)，函数不仅能把结构本身作为参数传递，还能把结构作为返回值返回。</p>
<blockquote>
<p>把结构作为函数参数可以把结构的信息传送给函数，把结构作为返回值的函数能把结构的信息从被调函数传回给主调函数。</p>
</blockquote>
</li>
</ul>
<p>👉<strong>小 Tips</strong>：结构指针允许双向通信。</p>
<p><strong>方法 1:使用指针方式 ————&gt; 传递地址</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp"># include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># include&lt;string.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp"># define NLEN 30
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">struct</span> <span class="nc">namect</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">fname</span><span class="p">[</span><span class="n">NLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">lname</span><span class="p">[</span><span class="n">NLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">letters</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">makeinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showinfo</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">namect</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">getinfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">persion</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">makeinfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">showinfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="n">pst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;please enter your first name.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s_gets</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">fname</span><span class="p">,</span><span class="n">NLEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;please enter your last name.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s_gets</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">lname</span><span class="p">,</span><span class="n">NLEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">makeinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="n">pst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">pst</span><span class="o">-&gt;</span><span class="n">letters</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">fname</span><span class="p">)</span> <span class="o">+</span> <span class="n">strlen</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">lname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showinfo</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="n">pst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s %s , your name contains %d letters.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">pst</span><span class="o">-&gt;</span><span class="n">fname</span><span class="p">,</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">lname</span><span class="p">,</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">letters</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span><span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span><span class="n">find</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">ret_val</span> <span class="o">=</span> <span class="n">fgets</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">find</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span><span class="c1">//查找换行符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">if</span><span class="p">(</span><span class="n">find</span><span class="p">)</span> <span class="c1">// 如果地址不是NULL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="o">*</span><span class="n">find</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="c1">// 放置一个空字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			<span class="k">while</span><span class="p">(</span><span class="n">getchar</span><span class="p">()</span> <span class="o">!=</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			 <span class="k">continue</span><span class="p">;</span> <span class="c1">// 处理输入行的剩余字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>方法 2：使用结构 ————&gt; 传递结构</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp"># include&lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"># include&lt;string.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp"># define NLEN 30
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">struct</span> <span class="nc">namect</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">fname</span><span class="p">[</span><span class="n">NLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">lname</span><span class="p">[</span><span class="n">NLEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">letters</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">namect</span> <span class="nf">getinfo</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">namect</span> <span class="nf">makeinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showinfo</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">namect</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">person</span> <span class="o">=</span> <span class="n">getinfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span> <span class="o">=</span> <span class="n">makeinfo</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">showinfo</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getinfo</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="nc">namect</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;please enter your first name.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s_gets</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="n">NLEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;please enter your last name.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s_gets</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">lname</span><span class="p">,</span><span class="n">NLEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">makeinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="o">*</span><span class="n">pst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">pst</span><span class="o">-&gt;</span><span class="n">letters</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">fname</span><span class="p">)</span> <span class="o">+</span> <span class="n">strlen</span><span class="p">(</span><span class="n">pst</span><span class="o">-&gt;</span><span class="n">lname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showinfo</span><span class="p">(</span><span class="k">struct</span> <span class="nc">namect</span> <span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s %s , your name contains %d letters.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">info</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">lname</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">letters</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="nf">s_gets</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span><span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span><span class="n">find</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">ret_val</span> <span class="o">=</span> <span class="n">fgets</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">find</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span><span class="c1">//查找换行符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">if</span><span class="p">(</span><span class="n">find</span><span class="p">)</span> <span class="c1">// 如果地址不是NULL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="o">*</span><span class="n">find</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="c1">// 放置一个空字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			<span class="k">while</span><span class="p">(</span><span class="n">getchar</span><span class="p">()</span> <span class="o">!=</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			 <span class="k">continue</span><span class="p">;</span> <span class="c1">// 处理输入行的剩余字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ret_val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>该方式中 makeinfo()函数返回的是一个结构。</p>
</blockquote>
<p>对于指针方式传递还是结构方式传递，两者输出结果相同，使用方式不同而已。</p>
<h2 id="10-结构和结构指针的选择">10 结构和结构指针的选择</h2>
<ul>
<li><strong>指针作为参数传递</strong>
<ul>
<li><strong>优点</strong>：无论是以前还是现在的 C 实现都能使用该方法，而且执行快，只需要<code>传递一个地址</code>。</li>
<li><strong>缺点</strong>：无法保护数据，故 ANSI C 新增<code>const限定符</code>可以解决这个问题。</li>
</ul>
</li>
<li><strong>结构作为参数传递</strong>
<ul>
<li><strong>优点</strong>：函数处理的是原始数据的副本，这可以保护原始数据。代码风格也很清楚。</li>
<li><strong>缺点</strong>：较老版本的实现可能无法处理，且传递结构浪费时间和存储空间。</li>
</ul>
</li>
</ul>
<p>👉<strong>小 Tips</strong>：</p>
<ul>
<li>
<p>程序员为了追求效率会使用<code>结构指针</code>作为函数参数，如需<code>防止原始数据被意外修改</code>，使用 <code>const限定符</code>。</p>
</li>
<li>
<p>按<code>值传递结构</code>是处理小型结构最常用的方法。</p>
</li>
</ul>
<h3 id="101-结构中的字符数组和字符指针">10.1 结构中的字符数组和字符指针</h3>
<p>如果要用结构储存字符串，用字符数组作为成员比较简单。用指向 char 的指针也行，但是误用会导致严重的问题。(指针最好只用来在程序中管理那些已分配和在别处分配的字符串)</p>
<h3 id="102-结构指针和malloc">10.2 结构、指针和<code>malloc()</code></h3>
<p>如果使用 <code>malloc()</code> 分配内存并使用指针存储该地址，那么在结构中使用指针处理字符串会比较合理。</p>
<p>优点：可以请求<code>malloc()</code>为字符串<code>分配合适的存储空间</code>。</p>
<p>⚠️ 注意：成对使用<code>malloc()</code>和<code>free()</code>(两个函数原型都在 <code>stdlib.h</code> 头文件中)。</p>
<h3 id="103-复合字面量和结构c99">10.3 复合字面量和结构(C99)</h3>
<p>C99 中的复合字面量特性可用于结构和数组。如果只需要一个临时结构值，推荐使用复合字面量。</p>
<blockquote>
<p>可以使用复合字面量创建一个数组作为函数的参数或赋给另一个结构。</p>
</blockquote>
<p><strong>语法</strong>：把<code>类型名</code>放在<code>圆括号</code>中，后紧跟一个<code>花括号</code>括起来的<code>初始化列表</code>。如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="p">(</span><span class="k">struct</span> <span class="nc">book</span><span class="p">){</span><span class="s">&#34;The Idiot&#34;</span><span class="p">,</span><span class="s">&#34;Fyodor Destroyevsky&#34;</span><span class="p">,</span><span class="mf">6.99</span><span class="p">}</span>
</span></span></code></pre></div><p><strong>关于复合字面量总结</strong>：</p>
<ul>
<li>在所有<code>函数的外部</code>，具有<code>静态存储器</code>。</li>
<li>在<code>块中</code>，则具有<code>自动存储期</code>。</li>
<li>复合字面量和普通初始化列表的语法规则相同。</li>
</ul>
<h3 id="104-伸缩型数组成员c99">10.4 伸缩型数组成员(C99)</h3>
<p><code>声明伸缩型数组成员</code>会具有的特性：</p>
<ul>
<li>数组不会立即存在。</li>
<li>可以编写合适的代码。</li>
</ul>
<p><strong>声明的规则</strong>：</p>
<ul>
<li>必须是结构的最后一个成员。</li>
<li>结构中必须至少有一个成员。</li>
<li>类似普通数组，只是方括号中是空的。</li>
</ul>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">flex</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">average</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">scores</span><span class="p">[];</span> <span class="c1">// 伸缩型数组成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span></code></pre></div><p><strong>特殊要求</strong></p>
<ul>
<li>不能用结构进行赋值或拷贝。</li>
<li>不要以按值方式把结构传递给结构。<strong>原因</strong>：按值传递参数与赋值类似，把结构的地址传递给函数。</li>
<li>不要使用带伸缩型数组成员的结构作为数组成员或另一个结构的成员。</li>
</ul>
<h3 id="105-匿名结构c11">10.5 匿名结构(C11)</h3>
<p>匿名结构 <code>没有名称</code> 的结构成员。</p>
<p>匿名特性在嵌套联合中更加有用。</p>
<h2 id="11-联合简介">11 联合简介</h2>
<p><code>联合(union)</code>是一种数据类型。能在同一个内存空间中存储不同的数据类型(不是同时存储)。</p>
<p>典型用法：设计一种表以储存既无规律、事先不知道顺序的混合类型。</p>
<p>使用混合类型的数组，其中的联合都大小相等，每个联合可以存储各种数据类型。</p>
<p>带标记的联合模版</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">union</span> <span class="nc">hold</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">digit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">bigfl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">letter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>与 hold 类型相关的变量：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">union</span> <span class="nc">hold</span> <span class="n">fit</span><span class="p">;</span>			<span class="c1">// hold类型的联合变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">union</span> <span class="nc">hold</span> <span class="n">save</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>	<span class="c1">// 内含10个联合变量的数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">union</span> <span class="nc">hold</span> <span class="o">*</span><span class="n">pu</span><span class="p">;</span> 		<span class="c1">//指向hold类型联合变量的指针
</span></span></span></code></pre></div><p>⚠️ 注意：联合只能存储一个值。</p>
<p>初始化联合的方法</p>
<ul>
<li>把一个联合初始化为另一个同类型联合。</li>
<li>初始化联合的第一个元素。</li>
<li>C99 标注，使用指定初始化器。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">union</span> <span class="nc">hold</span> <span class="n">valA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">valA</span><span class="p">.</span><span class="n">letter</span> <span class="o">=</span> <span class="sc">&#39;R&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">union</span> <span class="nc">hold</span> <span class="n">valB</span> <span class="o">=</span> <span class="n">valA</span><span class="p">;</span><span class="c1">//另一个同类型联合
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">union</span> <span class="nc">hold</span> <span class="n">valC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">88</span><span class="p">};</span><span class="c1">//初始化联合的第一个元素digit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">union</span> <span class="nc">hold</span> <span class="n">valD</span> <span class="o">=</span> <span class="p">{.</span><span class="n">bigfl</span> <span class="o">=</span> <span class="mf">118.2</span><span class="p">};</span><span class="c1">//指定初始化器
</span></span></span></code></pre></div><h3 id="111-使用联合">11.1 使用联合</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">fit</span><span class="p">.</span><span class="n">digit</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>   <span class="c1">// 把23存储在fit，占2字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">fit</span><span class="p">.</span><span class="n">digfl</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>  <span class="c1">// 清除23，存储2.0.占8字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">fit</span><span class="p">.</span><span class="n">letter</span> <span class="o">=</span> <span class="sc">&#39;h&#39;</span><span class="p">;</span> <span class="c1">// 清除2.0，存储h，占1个字节
</span></span></span></code></pre></div><p><code>点运算符</code>：表示正在使用哪种数据类型。</p>
<p>用指针访问联合时要使用<code>-&gt;运算符</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">pu</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">fit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">pu</span><span class="o">-&gt;</span><span class="n">digit</span><span class="p">;</span><span class="c1">//相当于 x = fit.digit
</span></span></span></code></pre></div><p>在结构中储存与其成员有从属关系的信息(用一个成员把值储存在一个联合中，然后用另一个成员查看内容)。</p>
<p>匿名联合：一个机构或者联合的无名联合成员。</p>
<h2 id="12-枚举类型">12 枚举类型</h2>
<p>可以用<code>枚举类型(enumerated type)声明符号名称来表示整型变量</code>。使用<code>enum关键字</code>，可以创建一个新“类型”并指定它可具有的值(语法与结构的语法相同)。</p>
<p>目的:提高程序的可读性。</p>
<p>默认情况下，枚举常量是 int 类型的值，枚举列表中的常量都被赋予 0，1，2 等以此类推。</p>
<p>⚠️ 注意：C 允许枚举变量使用 ++ 运算符，在 C++标准中是不允许使用。</p>
<p>在枚举声明中，可以为枚举常量指定整数值。</p>
<blockquote>
<p>如果只给一个枚举常量赋值，没有对后面的枚举常量赋值，那么后面的常量会被后续赋值。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">feline</span> <span class="p">{</span><span class="n">cat</span><span class="p">,</span> <span class="n">lynx</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">puma</span><span class="p">,</span> <span class="n">tiger</span><span class="p">};</span>
</span></span></code></pre></div></blockquote>
<h3 id="121-枚举-enum-的用法">12.1 枚举 enum 的用法</h3>
<p>目的：提高程序的可读性和可维护性。</p>
<p>枚举和宏其实非常类似：宏在预处理阶段将名字替换成对应的值，枚举在编译阶段将名字替换成对应的值</p>
<p>枚举语法定义格式为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">enum</span><span class="err">　枚举名　</span><span class="p">{</span><span class="err">枚举元素</span><span class="mi">1</span><span class="p">,</span><span class="err">枚举元素</span><span class="mi">2</span><span class="p">,</span><span class="err">……</span><span class="p">};</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">enum</span> <span class="n">DAY</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">MON</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TUE</span><span class="p">,</span> <span class="n">WED</span><span class="p">,</span> <span class="n">THU</span><span class="p">,</span> <span class="n">FRI</span><span class="p">,</span> <span class="n">SAT</span><span class="p">,</span> <span class="n">SUN</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>在 C 语言中，枚举类型是被当做 int 或者 unsigned int 类型来处理的，所以按照 C 语言规范是没有办法遍历枚举类型的。</p>
<p>⚠️ 注意：枚举只能在<code>内部使用</code>。</p>
<h2 id="13-typedef-简介">13 typedef 简介</h2>
<p>typedef 是高级数据特性。利用 typedef 可以为某一类型自定义名称。</p>
<p>typedef 的作用域取决于 typedef 定义所在的位置。</p>
<blockquote>
<p>如果定义在<code>函数内部</code>，属<code>局部作用域</code>。
如果在<code>函数外部</code>，则具有<code>文件作用域</code>。</p>
</blockquote>
<h3 id="131-typedef-和-define-的区别">13.1 <code>typedef</code> 和 <code>define</code> 的区别</h3>
<ul>
<li><code>typedef</code>创建的符号名只受限与类型，不能用于值。</li>
<li><code>typedef</code> 由<code>编译器</code>解释，而不是<code>预处理器</code>。</li>
<li>在其受限范围里，<code>typedef</code>比<code>#define</code>更灵活</li>
</ul>
<p>一般情况下，typeded 定义中使用<code>大写字母</code>表示<code>被定义的名称</code>。也可以使用小写。</p>
<blockquote>
<p>typedef 中使用的名称遵循变量命名的规则。</p>
</blockquote>
<p>将<code>typedef</code>用于来命名一个结构类型时，可以<code>省略结构的标签</code>。</p>
<h3 id="132-使用-typedef-的原因">13.2 使用 typedef 的原因</h3>
<ul>
<li>为经常出现的类型创建一个方便、易识别的类型名。</li>
<li>typedef 常用来给复杂的类型命名。</li>
</ul>
<p>⚠️ 注意：使用<code>typedef</code>时，typedef 并没有创建任何新类型，只是为某个已存在的类型增加方便使用的标签。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/c/">C</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>更新于 2022-09-12</span>
            </div><div class="post-info-mod"></div>
        </div></div><div class="post-nav"><a href="/posts/language/c/c_cpp%E8%AF%AD%E8%A8%80%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/" class="prev" rel="prev" title="C CPP语言运算符优先级"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/language/c/%E4%BD%8D%E6%93%8D%E4%BD%9C/" class="next" rel="next" title="位操作">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.112.4">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.zh.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body></html>
