<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>mysql详细笔记7-8章 - xcx</title><meta name="description" content=""><meta property="og:title" content="mysql详细笔记7-8章" />
<meta property="og:description" content="mysq详细笔记 [toc] 第7章 单行函数 7.1 函数的理解 1 什么是函数 函数在计算机语言的使用中贯穿始终，函数的作用是什么呢？它可以把我们经常使用的代码封装" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiechaoxin.github.io/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B07-8%E7%AB%A0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-17T17:59:12+00:00" />
<meta property="article:modified_time" content="2022-06-17T17:59:12+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="mysql详细笔记7-8章"/>
<meta name="twitter:description" content="mysq详细笔记 [toc] 第7章 单行函数 7.1 函数的理解 1 什么是函数 函数在计算机语言的使用中贯穿始终，函数的作用是什么呢？它可以把我们经常使用的代码封装"/>
<meta name="application-name" content="xcx">
<meta name="apple-mobile-web-app-title" content="xcx"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://xiechaoxin.github.io/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B07-8%E7%AB%A0/" /><link rel="prev" href="https://xiechaoxin.github.io/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B09-10%E7%AB%A0/" /><link rel="next" href="https://xiechaoxin.github.io/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B05-6%E7%AB%A0/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "mysql详细笔记7-8章",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/xiechaoxin.github.io\/posts\/database%E6%9C%AA%E5%A4%84%E7%90%86\/mysql\/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B07-8%E7%AB%A0\/"
        },"genre": "posts","keywords": "database, mysql","wordcount":  12986 ,
        "url": "https:\/\/xiechaoxin.github.io\/posts\/database%E6%9C%AA%E5%A4%84%E7%90%86\/mysql\/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B07-8%E7%AB%A0\/","datePublished": "2022-06-17T17:59:12+00:00","dateModified": "2022-06-17T17:59:12+00:00","publisher": {
            "@type": "Organization",
            "name": "作者"},"author": {
                "@type": "Person",
                "name": "作者"
            },"description": ""
    }
    </script></head><body data-header-desktop="" data-header-mobile=""><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="xcx">xcx</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="在客户端搜索可能比较慢~" id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" onclick="return false;" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="xcx">xcx</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="在客户端搜索可能比较慢~" id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><div class="menu-item"><a href="#" onclick="return false;" class="theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="single-card" ><h2 class="single-title animated flipInX">mysql详细笔记7-8章</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>作者</a></span>&nbsp;<span class="post-category">出版于  <a href="/categories/database/"><i class="far fa-folder fa-fw"></i>database</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-06-17">2022-06-17</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 12986 字</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 26 分钟</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>目录</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#71-函数的理解">7.1 函数的理解</a></li>
    <li><a href="#1-什么是函数">1 什么是函数</a>
      <ul>
        <li><a href="#11-不同dbms函数的差异">1.1 不同DBMS函数的差异</a></li>
        <li><a href="#12-mysql的内置函数及分类">1.2 MySQL的内置函数及分类</a></li>
      </ul>
    </li>
    <li><a href="#72-数值函数">7.2 数值函数</a>
      <ul>
        <li><a href="#13-基本函数">1.3 基本函数</a></li>
        <li><a href="#14-角度与弧度互换函数">1.4 角度与弧度互换函数</a></li>
        <li><a href="#15-三角函数">1.5 三角函数</a></li>
        <li><a href="#16-三角函数">1.6 三角函数</a></li>
        <li><a href="#17-进制间的转换">1.7 进制间的转换</a></li>
      </ul>
    </li>
    <li><a href="#73-字符串函数">7.3 字符串函数</a></li>
    <li><a href="#74-日期和时间函数">7.4 日期和时间函数</a>
      <ul>
        <li><a href="#18-获取日期时间">1.8 获取日期、时间</a></li>
        <li><a href="#19-日期与时间戳的转换">1.9 日期与时间戳的转换</a></li>
        <li><a href="#110-获取月份星期星期数天数等函数">1.10 获取月份、星期、星期数、天数等函数</a></li>
        <li><a href="#111-日期的操作函数">1.11 日期的操作函数</a></li>
        <li><a href="#112-时间和秒钟转换的函数">1.12 时间和秒钟转换的函数</a></li>
        <li><a href="#113-计算日期和时间的函数">1.13 计算日期和时间的函数</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#2-日期的格式化与解析">2 日期的格式化与解析</a></li>
    <li><a href="#75-流程控制函数">7.5 流程控制函数</a></li>
    <li><a href="#76-流程控制函数">7.6 流程控制函数</a></li>
    <li><a href="#77-mysql信息函数">7.7 MySQL信息函数</a></li>
    <li><a href="#78-其他函数">7.8 其他函数</a></li>
  </ul>

  <ul>
    <li><a href="#3-练习sql">3 练习sql</a></li>
  </ul>

  <ul>
    <li><a href="#81-聚合函数介绍">8.1 聚合函数介绍</a></li>
    <li><a href="#4-avg和sum函数">4 AVG和SUM函数</a>
      <ul>
        <li><a href="#41-min和max函数">4.1 MIN和MAX函数</a></li>
        <li><a href="#42-count函数">4.2 COUNT函数</a></li>
      </ul>
    </li>
    <li><a href="#82-group-by">8.2 GROUP BY</a>
      <ul>
        <li><a href="#43-基本使用">4.3 基本使用</a></li>
        <li><a href="#44-使用多个列分组">4.4 使用多个列分组</a></li>
        <li><a href="#45-group-by中使用with-rollup">4.5 GROUP BY中使用WITH ROLLUP</a></li>
      </ul>
    </li>
    <li><a href="#83-having">8.3 HAVING</a>
      <ul>
        <li><a href="#46-基本使用">4.6 基本使用</a></li>
        <li><a href="#47-where和having的对比">4.7 WHERE和HAVING的对比</a></li>
      </ul>
    </li>
    <li><a href="#84-select的执行过程">8.4 SELECT的执行过程</a>
      <ul>
        <li><a href="#48-查询的结构">4.8 查询的结构</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#5-select执行顺序">5 SELECT执行顺序</a>
      <ul>
        <li><a href="#51-sql-的执行原理">5.1 SQL 的执行原理</a></li>
      </ul>
    </li>
    <li><a href="#84-练习sql">8.4. 练习sql</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="mysq详细笔记">mysq详细笔记</h1>
<p>[toc]</p>
<h1 id="第7章-单行函数">第7章 单行函数</h1>
<h2 id="71-函数的理解">7.1 函数的理解</h2>
<h2 id="1-什么是函数">1 什么是函数</h2>
<blockquote>
<p>函数在计算机语言的使用中贯穿始终，函数的作用是什么呢？它可以把我们经常使用的代码封装起来，需要的时候直接调用即可。这样既提高了代码效率，又提高了可维护性。在 SQL 中我们也可以使用函数对检索出来的数据进行函数操作。使用这些函数，可以极大地提高用户对数据库的管理效率。</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220513230738229.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230738229.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230738229.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230738229.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220513230738229.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p>从函数定义的角度出发，我们可以将函数分成内置函数和自定义函数。在 SQL 语言中，同样也包括了内置函数和自定义函数。内置函数是系统内置的通用函数，而自定义函数是我们根据自己的需要编写的，本章及下一章讲解的是 SQL 的内置函数。</p>
</blockquote>
<h3 id="11-不同dbms函数的差异">1.1 不同DBMS函数的差异</h3>
<blockquote>
<p>我们在使用 SQL 语言的时候，不是直接和这门语言打交道，而是通过它使用不同的数据库软件，即 DBMS。DBMS 之间的差异性很大，远大于同一个语言不同版本之间的差异。实际上，只有很少的函数是被 DBMS 同时支持的。比如，大多数 DBMS 使用(||)或者(+)来做拼接符，而在 MySQL 中的字符串拼接函数为concat()。大部分 DBMS 会有自己特定的函数，这就意味着采用 SQL 函数的代码可移植性是很差的，因此在使用函数的时候需要特别注意。</p>
</blockquote>
<h3 id="12-mysql的内置函数及分类">1.2 MySQL的内置函数及分类</h3>
<blockquote>
<ul>
<li>MySQL提供了丰富的内置函数，这些函数使得数据的维护与管理更加方便，能够更好地提供数据的分析与统计功能，在一定程度上提高了开发人员进行数据分析与统计的效率。</li>
<li>MySQL提供的内置函数从实现的功能角度可以分为数值函数、字符串函数、日期和时间函数、流程控制函数、加密与解密函数、获取MySQL信息函数、聚合函数等。这里，我将这些丰富的内置函数再分为两类：单行函数、聚合函数(或分组函数)。</li>
</ul>
</blockquote>
<p><strong>两种SQL函数</strong>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220513230749303.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230749303.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230749303.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220513230749303.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220513230749303.png"
        title="在这里插入图片描述" />
<strong>单行函数</strong></p>
<blockquote>
<ul>
<li>操作数据对象</li>
<li>接受参数返回一个结果</li>
<li>只对一行进行变换</li>
<li>每行返回一个结果</li>
<li>可以嵌套</li>
<li>参数可以是一列或一个值</li>
</ul>
</blockquote>
<h2 id="72-数值函数">7.2 数值函数</h2>
<h3 id="13-基本函数">1.3 基本函数</h3>
<p>函数</p>
<p>用法</p>
<p>ABS(x)</p>
<p>返回x的绝对值</p>
<p>SIGN(X)</p>
<p>返回X的符号。正数返回1，负数返回-1，0返回0</p>
<p>PI()</p>
<p>返回圆周率的值</p>
<p>CEIL(x)，CEILING(x)</p>
<p>返回大于或等于某个值的最小整数</p>
<p>FLOOR(x)</p>
<p>返回小于或等于某个值的最大整数</p>
<p>LEAST(e1,e2,e3…)</p>
<p>返回列表中的最小值</p>
<p>GREATEST(e1,e2,e3…)</p>
<p>返回列表中的最大值</p>
<p>MOD(x,y)</p>
<p>返回X除以Y后的余数</p>
<p>RAND()</p>
<p>返回0~1的随机值</p>
<p>RAND(x)</p>
<p>返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机数</p>
<p>ROUND(x)</p>
<p>返回一个对x的值进行四舍五入后，最接近于X的整数</p>
<p>ROUND(x,y)</p>
<p>返回一个对x的值进行四舍五入后最接近X的值，并保留到小数点后面Y位</p>
<p>TRUNCATE(x,y)</p>
<p>返回数字x截断为y位小数的结果</p>
<p>SQRT(x)</p>
<p>返回x的平方根。当X的值为负数时，返回NULL</p>
<p><strong>举例</strong></p>
<pre><code>SELECT ABS(-123),ABS(123),SIGN(-23),SIGN(23),PI(),CEIL(32.32),
	   CEILING(-43.23),FLOOR(32.32),FLOOR(-43.23),MOD(12,5)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./08c49659f63b458392ad8ce7a055bd97.png"
        data-srcset="./08c49659f63b458392ad8ce7a055bd97.png, ./08c49659f63b458392ad8ce7a055bd97.png 1.5x, ./08c49659f63b458392ad8ce7a055bd97.png 2x"
        data-sizes="auto"
        alt="./08c49659f63b458392ad8ce7a055bd97.png"
        title="./08c49659f63b458392ad8ce7a055bd97.png" /></p>
<pre><code>SELECT RAND(),RAND(),RAND(10),RAND(10),RAND(-1),RAND(-1)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./01bf91a97c6e463b810a2d7adc430078.png"
        data-srcset="./01bf91a97c6e463b810a2d7adc430078.png, ./01bf91a97c6e463b810a2d7adc430078.png 1.5x, ./01bf91a97c6e463b810a2d7adc430078.png 2x"
        data-sizes="auto"
        alt="./01bf91a97c6e463b810a2d7adc430078.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT ROUND(12.33),ROUND(12.343,2),ROUND(12.324,-1),TRUNCATE(12.66,1),TRUNCATE(12.66,-1)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./361d1584fae046fc9fdf013110062368.png"
        data-srcset="./361d1584fae046fc9fdf013110062368.png, ./361d1584fae046fc9fdf013110062368.png 1.5x, ./361d1584fae046fc9fdf013110062368.png 2x"
        data-sizes="auto"
        alt="./361d1584fae046fc9fdf013110062368.png"
        title="在这里插入图片描述" /></p>
<h3 id="14-角度与弧度互换函数">1.4 角度与弧度互换函数</h3>
<p>函数</p>
<p>用法</p>
<p>RADIANS(x)</p>
<p>将角度转化为弧度，其中，参数x为角度值</p>
<p>DEGREES(x)</p>
<p>将弧度转化为角度，其中，参数x为弧度值</p>
<pre><code>SELECT RADIANS(30),RADIANS(60),RADIANS(90),DEGREES(2*PI()),DEGREES(RADIANS(90))
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./8b76f7d24c6a4689bc0627143ca6e539.png"
        data-srcset="./8b76f7d24c6a4689bc0627143ca6e539.png, ./8b76f7d24c6a4689bc0627143ca6e539.png 1.5x, ./8b76f7d24c6a4689bc0627143ca6e539.png 2x"
        data-sizes="auto"
        alt="./8b76f7d24c6a4689bc0627143ca6e539.png"
        title="在这里插入图片描述" /></p>
<h3 id="15-三角函数">1.5 三角函数</h3>
<p>函数</p>
<p>用法</p>
<p>SIN(x)</p>
<p>返回x的正弦值，其中，参数x为弧度值</p>
<p>ASIN(x)</p>
<p>返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL</p>
<p>COS(x)</p>
<p>返回x的余弦值，其中，参数x为弧度值</p>
<p>ACOS(x)</p>
<p>返回x的反余弦值，即获取余弦为x的值。如果x的值不在-1到1之间，则返回NULL</p>
<p>TAN(x)</p>
<p>返回x的正切值，其中，参数x为弧度值</p>
<p>ATAN(x)</p>
<p>返回x的反正切值，即返回正切值为x的值</p>
<p>ATAN2(m,n)</p>
<p>返回两个参数的反正切值</p>
<p>COT(x)</p>
<p>返回x的余切值，其中，X为弧度值</p>
<p><strong>举例</strong></p>
<blockquote>
<p>ATAN2(M,N)函数返回两个参数的反正切值。
与ATAN(X)函数相比，ATAN2(M,N)需要两个参数，例如有两个点point(x1,y1)和point(x2,y2)，使用ATAN(X)函数计算反正切值为ATAN((y2-y1)/(x2-x1))，使用ATAN2(M,N)计算反正切值则为ATAN2(y2-y1,x2-x1)。由使用方式可以看出，当x2-x1等于0时，ATAN(X)函数会报错，而ATAN2(M,N)函数则仍然可以计算。</p>
</blockquote>
<p>ATAN2(M,N)函数的使用示例如下：</p>
<pre><code>SELECT SIN(RADIANS(30)),DEGREES(ASIN(1)),TAN(RADIANS(45)),DEGREES(ATAN(1)),DEGREES(ATAN2(1,1))
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./b2d0810e112845539144294e9817bd2b.png"
        data-srcset="./b2d0810e112845539144294e9817bd2b.png, ./b2d0810e112845539144294e9817bd2b.png 1.5x, ./b2d0810e112845539144294e9817bd2b.png 2x"
        data-sizes="auto"
        alt="./b2d0810e112845539144294e9817bd2b.png"
        title="在这里插入图片描述" /></p>
<h3 id="16-三角函数">1.6 三角函数</h3>
<p>函数</p>
<p>用法</p>
<p>POW(x,y)，</p>
<p>POWER(X,Y) 返回x的y次方</p>
<p>EXP(X)</p>
<p>返回e的X次方，其中e是一个常数，2.718281828459045</p>
<p>LN(X)，LOG(X)</p>
<p>返回以e为底的X的对数，当X &lt;= 0 时，返回的结果为NULL</p>
<p>LOG10(X)</p>
<p>返回以10为底的X的对数，当X &lt;= 0 时，返回的结果为NULL</p>
<p>LOG2(X)</p>
<p>返回以2为底的X的对数，当X &lt;= 0 时，返回NULL</p>
<pre><code>SELECT POW(2,5),POWER(2,4),EXP(2),LN(10),LOG10(10),LOG2(4)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./bceb5080226a4cb9934a042f90b2e2f4.png"
        data-srcset="./bceb5080226a4cb9934a042f90b2e2f4.png, ./bceb5080226a4cb9934a042f90b2e2f4.png 1.5x, ./bceb5080226a4cb9934a042f90b2e2f4.png 2x"
        data-sizes="auto"
        alt="./bceb5080226a4cb9934a042f90b2e2f4.png"
        title="在这里插入图片描述" /></p>
<h3 id="17-进制间的转换">1.7 进制间的转换</h3>
<p>函数</p>
<p>用法</p>
<p>BIN(x)</p>
<p>返回x的二进制编码</p>
<p>HEX(x)</p>
<p>返回x的十六进制编码</p>
<p>OCT(x)</p>
<p>返回x的八进制编码</p>
<p>CONV(x,f1,f2)</p>
<p>返回f1进制数变成f2进制数</p>
<pre><code>SELECT BIN(10),HEX(10),OCT(10),CONV(10,2,8)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./7f2824169dad4332b899615c9a64cdfa.png"
        data-srcset="./7f2824169dad4332b899615c9a64cdfa.png, ./7f2824169dad4332b899615c9a64cdfa.png 1.5x, ./7f2824169dad4332b899615c9a64cdfa.png 2x"
        data-sizes="auto"
        alt="./7f2824169dad4332b899615c9a64cdfa.png"
        title="在这里插入图片描述" /></p>
<h2 id="73-字符串函数">7.3 字符串函数</h2>
<p>函数</p>
<p>用法</p>
<p>ASCII(S)</p>
<p>返回字符串S中的第一个字符的ASCII码值</p>
<p>CHAR_LENGTH(s)</p>
<p>返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同</p>
<p>LENGTH(s)</p>
<p>返回字符串s的字节数，和字符集有关</p>
<p>CONCAT(s1,s2,…,sn)</p>
<p>连接s1,s2,…,sn为一个字符串</p>
<p>CONCAT_WS(x, s1,s2,…,sn)</p>
<p>同CONCAT(s1,s2,…)函数，但是每个字符串之间要加上x</p>
<p>INSERT(str, idx, len, replacestr)</p>
<p>将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr</p>
<p>REPLACE(str, a, b)</p>
<p>用字符串b替换字符串str中所有出现的字符串a</p>
<p>UPPER(s) 或 UCASE(s)</p>
<p>将字符串s的所有字母转成大写字母</p>
<p>LOWER(s) 或LCASE(s)</p>
<p>将字符串s的所有字母转成小写字母</p>
<p>LEFT(str,n)</p>
<p>返回字符串str最左边的n个字符</p>
<p>RIGHT(str,n)</p>
<p>返回字符串str最右边的n个字符</p>
<p>LPAD(str, len, pad)</p>
<p>用字符串pad对str最左边进行填充，直到str的长度为len个字符</p>
<p>RPAD(str ,len, pad)</p>
<p>用字符串pad对str最右边进行填充，直到str的长度为len个字符</p>
<p>LTRIM(s)</p>
<p>去掉字符串s左侧的空格</p>
<p>RTRIM(s)</p>
<p>去掉字符串s右侧的空格</p>
<p>TRIM(s)</p>
<p>去掉字符串s开始与结尾的空格</p>
<p>TRIM(s1 FROM s)</p>
<p>去掉字符串s开始与结尾的s1</p>
<p>TRIM(LEADING s1 FROM s)</p>
<p>去掉字符串s开始处的s1</p>
<p>TRIM(TRAILING s1 FROM s)</p>
<p>去掉字符串s结尾处的s1</p>
<p>REPEAT(str, n)</p>
<p>返回str重复n次的结果</p>
<p>SPACE(n)</p>
<p>返回n个空格</p>
<p>STRCMP(s1,s2)</p>
<p>比较字符串s1,s2的ASCII码值的大小</p>
<p>SUBSTR(s,index,len)</p>
<p>返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、MID(s,n,len)相同</p>
<p>LOCATE(substr,str)</p>
<p>返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substr IN str)、INSTR(str,substr)相同。未找到，返回0</p>
<p>ELT(m,s1,s2,…,sn)</p>
<p>返回指定位置的字符串，如果m=1，则返回s1，如果m=2，则返回s2，如果m=n，则返回sn</p>
<p>FIELD(s,s1,s2,…,sn)</p>
<p>返回字符串s在字符串列表中第一次出现的位置</p>
<p>FIND_IN_SET(s1,s2)</p>
<p>返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串</p>
<p>REVERSE(s)</p>
<p>返回s反转后的字符串</p>
<p>NULLIF(value1,value2)</p>
<p>比较两个字符串，如果value1与value2相等，则返回NULL，否则返回value1</p>
<blockquote>
<p>注意：MySQL中，字符串的位置是从1开始的。</p>
</blockquote>
<pre><code>SELECT FIELD('mm','hello','msm','amma'),FIND_IN_SET('mm','hello,mm,amma')
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./618610f74f5f4331ba249d8031de19b0.png"
        data-srcset="./618610f74f5f4331ba249d8031de19b0.png, ./618610f74f5f4331ba249d8031de19b0.png 1.5x, ./618610f74f5f4331ba249d8031de19b0.png 2x"
        data-sizes="auto"
        alt="./618610f74f5f4331ba249d8031de19b0.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT NULLIF('mysql','mysql'),NULLIF('mysql', '');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./eb150d95799c4f158362cda2a193197a.png"
        data-srcset="./eb150d95799c4f158362cda2a193197a.png, ./eb150d95799c4f158362cda2a193197a.png 1.5x, ./eb150d95799c4f158362cda2a193197a.png 2x"
        data-sizes="auto"
        alt="./eb150d95799c4f158362cda2a193197a.png"
        title="在这里插入图片描述" /></p>
<h2 id="74-日期和时间函数">7.4 日期和时间函数</h2>
<h3 id="18-获取日期时间">1.8 获取日期、时间</h3>
<p>函数</p>
<p>用法</p>
<p>CURDATE() ，CURRENT_DATE()</p>
<p>返回当前日期，只包含年、月、日</p>
<p>CURTIME() ， CURRENT_TIME()</p>
<p>返回当前时间，只包含时、分、秒</p>
<p>NOW() / SYSDATE() / CURRENT_TIMESTAMP() / LOCALTIME() / LOCALTIMESTAMP()</p>
<p>返回当前系统日期和时间</p>
<p>UTC_DATE()</p>
<p>返回UTC(世界标准时间)日期</p>
<p>UTC_TIME()</p>
<p>返回UTC(世界标准时间)时间</p>
<pre><code>SELECT CURDATE(),CURTIME(),NOW(),SYSDATE()+0,UTC_DATE(),UTC_DATE()+0,UTC_TIME(),UTC_TIME()+0
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./a2edbd532dc74f5cb01c8bb3bf767a93.png"
        data-srcset="./a2edbd532dc74f5cb01c8bb3bf767a93.png, ./a2edbd532dc74f5cb01c8bb3bf767a93.png 1.5x, ./a2edbd532dc74f5cb01c8bb3bf767a93.png 2x"
        data-sizes="auto"
        alt="./a2edbd532dc74f5cb01c8bb3bf767a93.png"
        title="在这里插入图片描述" /></p>
<h3 id="19-日期与时间戳的转换">1.9 日期与时间戳的转换</h3>
<p>函数</p>
<p>用法</p>
<p>UNIX_TIMESTAMP()</p>
<p>以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() -&gt;1634348884</p>
<p>UNIX_TIMESTAMP(date)</p>
<p>将时间date以UNIX时间戳的形式返回。</p>
<p>FROM_UNIXTIME(timestamp)</p>
<p>将UNIX时间戳的时间转换为普通格式的时间</p>
<p><strong>举例</strong></p>
<pre><code>SELECT UNIX_TIMESTAMP(NOW());
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./8df87645a3fb463cb593aa3f4aef90d7.png"
        data-srcset="./8df87645a3fb463cb593aa3f4aef90d7.png, ./8df87645a3fb463cb593aa3f4aef90d7.png 1.5x, ./8df87645a3fb463cb593aa3f4aef90d7.png 2x"
        data-sizes="auto"
        alt="./8df87645a3fb463cb593aa3f4aef90d7.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT UNIX_TIMESTAMP(CURDATE());
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./a3914ebab4ed4f2f9e8429780001940d.png"
        data-srcset="./a3914ebab4ed4f2f9e8429780001940d.png, ./a3914ebab4ed4f2f9e8429780001940d.png 1.5x, ./a3914ebab4ed4f2f9e8429780001940d.png 2x"
        data-sizes="auto"
        alt="./a3914ebab4ed4f2f9e8429780001940d.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT UNIX_TIMESTAMP('2011-11-11 11:11:11')
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./1ed6ceae98ab4dedbf2be4f87c32def4.png"
        data-srcset="./1ed6ceae98ab4dedbf2be4f87c32def4.png, ./1ed6ceae98ab4dedbf2be4f87c32def4.png 1.5x, ./1ed6ceae98ab4dedbf2be4f87c32def4.png 2x"
        data-sizes="auto"
        alt="./1ed6ceae98ab4dedbf2be4f87c32def4.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT FROM_UNIXTIME(1576380910);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./ca86d89287be47fbbc0ccf542fb57a63.png"
        data-srcset="./ca86d89287be47fbbc0ccf542fb57a63.png, ./ca86d89287be47fbbc0ccf542fb57a63.png 1.5x, ./ca86d89287be47fbbc0ccf542fb57a63.png 2x"
        data-sizes="auto"
        alt="./ca86d89287be47fbbc0ccf542fb57a63.png"
        title="在这里插入图片描述" /></p>
<h3 id="110-获取月份星期星期数天数等函数">1.10 获取月份、星期、星期数、天数等函数</h3>
<p>函数</p>
<p>用法</p>
<p>YEAR(date) / MONTH(date) / DAY(date)</p>
<p>返回具体的日期值</p>
<p>HOUR(time) / MINUTE(time) / SECOND(time)</p>
<p>返回具体的时间值</p>
<p>MONTHNAME(date)</p>
<p>返回月份：January，…</p>
<p>DAYNAME(date)</p>
<p>返回星期几：MONDAY，TUESDAY…SUNDAY</p>
<p>WEEKDAY(date)</p>
<p>返回周几，注意，周1是0，周2是1，。。。周日是6</p>
<p>QUARTER(date)</p>
<p>返回日期对应的季度，范围为1～4</p>
<p>WEEK(date) ， WEEKOFYEAR(date)</p>
<p>返回一年中的第几周</p>
<p>DAYOFYEAR(date)</p>
<p>返回日期是一年中的第几天</p>
<p>DAYOFMONTH(date)</p>
<p>返回日期位于所在月份的第几天</p>
<p>DAYOFWEEK(date)</p>
<p>返回周几，注意：周日是1，周一是2，。。。周六是7</p>
<pre><code>SELECT YEAR(CURDATE()),MONTH(CURDATE()),DAY(CURDATE()),
HOUR(CURTIME()),MINUTE(NOW()),SECOND(SYSDATE())
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./367b529c2c8540fe8e504595f8c9a326.png"
        data-srcset="./367b529c2c8540fe8e504595f8c9a326.png, ./367b529c2c8540fe8e504595f8c9a326.png 1.5x, ./367b529c2c8540fe8e504595f8c9a326.png 2x"
        data-sizes="auto"
        alt="./367b529c2c8540fe8e504595f8c9a326.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT MONTHNAME('2021-10-26'),DAYNAME('2021-10-26'),WEEKDAY('2021-10-26'),
QUARTER(CURDATE()),WEEK(CURDATE()),DAYOFYEAR(NOW()),
DAYOFMONTH(NOW()),DAYOFWEEK(NOW())
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./88c5ce12d5644e94aba87aade1bbec8b.png"
        data-srcset="./88c5ce12d5644e94aba87aade1bbec8b.png, ./88c5ce12d5644e94aba87aade1bbec8b.png 1.5x, ./88c5ce12d5644e94aba87aade1bbec8b.png 2x"
        data-sizes="auto"
        alt="./88c5ce12d5644e94aba87aade1bbec8b.png"
        title="在这里插入图片描述" /></p>
<h3 id="111-日期的操作函数">1.11 日期的操作函数</h3>
<p>函数</p>
<p>用法</p>
<p>EXTRACT(type FROM date)</p>
<p>返回指定日期中特定的部分，type指定返回的值</p>
<p><strong>EXTRACT(type FROM date)函数中type的取值与含义：</strong></p>
<p>type取值</p>
<p>含义</p>
<p>–</p>
<p>–</p>
<p>MICROSECOND</p>
<p>返回毫秒值</p>
<p>SECOND</p>
<p>返回秒数</p>
<p>MINUTE</p>
<p>返回分钟数</p>
<p>HOUR</p>
<p>返回小时数</p>
<p>DAY</p>
<p>返回天数</p>
<p>WEEK</p>
<p>返回日期在一年中的第几个星期</p>
<p>MONTH</p>
<p>返回日期在一年中的第几个月</p>
<p>QUARTER</p>
<p>返回日期在一年中的第几个季度</p>
<p>YEAR</p>
<p>返回日期的年丰</p>
<p>SECOND_MICROSECOND</p>
<p>返回秒和毫秒值</p>
<p>MINUTE_MICROSECOND</p>
<p>返回分钟和毫秒值</p>
<p>MINUTE_SECOND</p>
<p>返回分钟和秒值</p>
<p>HOUR_MICROSECOND</p>
<p>返回小时和毫秒值</p>
<p>HOUR_SECOND</p>
<p>返回小时和秒值</p>
<p>HOUR_MINUTE</p>
<p>返回小时和分钟值</p>
<p>DAY_MICROSECOND</p>
<p>返回天和毫秒值</p>
<p>DAY_SECOND</p>
<p>返回天和秒值</p>
<p>DAY_MINUTE</p>
<p>返回天和分钟值</p>
<p>DAY_HOUR</p>
<p>返回天和小时</p>
<p>YEAR_MONTH</p>
<p>返回年和月</p>
<pre><code>SELECT EXTRACT(MINUTE FROM NOW()),EXTRACT( WEEK FROM NOW()),
EXTRACT( QUARTER FROM NOW()),EXTRACT( MINUTE_SECOND FROM NOW())
FROM DUAL;
</code></pre>
<h3 id="112-时间和秒钟转换的函数">1.12 时间和秒钟转换的函数</h3>
<p>函数</p>
<p>用法</p>
<p>TIME_TO_SEC(time)</p>
<p>将 time 转化为秒并返回结果值。转化的公式为：小时_3600+分钟_60+秒</p>
<p>SEC_TO_TIME(seconds)</p>
<p>将 seconds 描述转化为包含小时、分钟和秒的时间</p>
<pre><code>SELECT TIME_TO_SEC(NOW());
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./e3f169857d144b3896f9a8ed4c16a73e.png"
        data-srcset="./e3f169857d144b3896f9a8ed4c16a73e.png, ./e3f169857d144b3896f9a8ed4c16a73e.png 1.5x, ./e3f169857d144b3896f9a8ed4c16a73e.png 2x"
        data-sizes="auto"
        alt="./e3f169857d144b3896f9a8ed4c16a73e.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT SEC_TO_TIME(71507);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./be4878706dbd489895b4b97a505fbce2.png"
        data-srcset="./be4878706dbd489895b4b97a505fbce2.png, ./be4878706dbd489895b4b97a505fbce2.png 1.5x, ./be4878706dbd489895b4b97a505fbce2.png 2x"
        data-sizes="auto"
        alt="./be4878706dbd489895b4b97a505fbce2.png"
        title="在这里插入图片描述" /></p>
<h3 id="113-计算日期和时间的函数">1.13 计算日期和时间的函数</h3>
<p>第一组:</p>
<p>函数</p>
<p>用法</p>
<p>DATE_ADD(datetime, INTERVAL expr type)，ADDDATE(date,INTERVAL expr type)</p>
<p>返回与给定日期时间相差INTERVAL时间段的日期时间</p>
<p>DATE_SUB(date,INTERVAL expr type)，SUBDATE(date,INTERVAL expr type)</p>
<p>返回与date相差INTERVAL时间间隔的日期</p>
<p>上述函数中type的取值:</p>
<p>间隔类型</p>
<p>含义</p>
<p>HOUR</p>
<p>小时</p>
<p>MINUTE</p>
<p>分钟</p>
<p>SECOND</p>
<p>秒</p>
<p>YEAR</p>
<p>年</p>
<p>MONTH</p>
<p>月</p>
<p>DAY</p>
<p>日</p>
<p>YEAR_MONTH</p>
<p>年和月</p>
<p>DAY_HOUR</p>
<p>日和小时</p>
<p>DAY_MINUTE</p>
<p>日和分钟</p>
<p>DAY_SECOND</p>
<p>日和秒</p>
<p>HOUR_MINUTE</p>
<p>小时和分钟</p>
<p>HOUR_SECOND</p>
<p>小时和秒</p>
<p>MINUTE_SECOND</p>
<p>分钟和秒</p>
<pre><code>SELECT DATE_ADD(NOW(), INTERVAL 1 DAY) AS col1,DATE_ADD('2022-2-26 20:02:02',INTERVAL 1 SECOND) AS col2,
       ADDDATE('2022-2-26 20:02:02',INTERVAL 1 SECOND) AS col3,
       DATE_ADD('2022-2-26 20:02:02',INTERVAL '1_1' MINUTE_SECOND) AS col4,
       DATE_ADD(NOW(), INTERVAL -1 YEAR) AS col5, #可以是负数
       DATE_ADD(NOW(), INTERVAL '1_1' YEAR_MONTH) AS col6 #需要单引号
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./77453bf238d04b628e295667ea2101bd.png"
        data-srcset="./77453bf238d04b628e295667ea2101bd.png, ./77453bf238d04b628e295667ea2101bd.png 1.5x, ./77453bf238d04b628e295667ea2101bd.png 2x"
        data-sizes="auto"
        alt="./77453bf238d04b628e295667ea2101bd.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT DATE_SUB('2022-2-26',INTERVAL 31 DAY) AS col1,
       SUBDATE('2022-2-26',INTERVAL 31 DAY) AS col2,
       DATE_SUB('2022-2-26 20:04:02',INTERVAL '1 1' DAY_HOUR) AS col3
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./843b241a153347e4af6a543a75d5f201.png"
        data-srcset="./843b241a153347e4af6a543a75d5f201.png, ./843b241a153347e4af6a543a75d5f201.png 1.5x, ./843b241a153347e4af6a543a75d5f201.png 2x"
        data-sizes="auto"
        alt="./843b241a153347e4af6a543a75d5f201.png"
        title="在这里插入图片描述" />
第二组:</p>
<p>函数</p>
<p>用法</p>
<p>ADDTIME(time1,time2)</p>
<p>返回time1加上time2的时间。当time2为一个数字时，代表的是<code>秒</code>，可以为负数</p>
<p>SUBTIME(time1,time2)</p>
<p>返回time1减去time2后的时间。当time2为一个数字时，代表的是<code>秒</code>，可以为负数</p>
<p>DATEDIFF(date1,date2)</p>
<p>返回date1 - date2的日期间隔天数</p>
<p>TIMEDIFF(time1, time2)</p>
<p>返回time1 - time2的时间间隔</p>
<p>FROM_DAYS(N)</p>
<p>返回从0000年1月1日起，N天以后的日期</p>
<p>TO_DAYS(date)</p>
<p>返回日期date距离0000年1月1日的天数</p>
<p>LAST_DAY(date)</p>
<p>返回date所在月份的最后一天的日期</p>
<p>MAKEDATE(year,n)</p>
<p>针对给定年份与所在年份中的天数返回一个日期</p>
<p>MAKETIME(hour,minute,second)</p>
<p>将给定的小时、分钟和秒组合成时间并返回</p>
<p>PERIOD_ADD(time,n)</p>
<p>返回time加上n后的时间</p>
<pre><code>SELECT ADDTIME(NOW(),20),SUBTIME(NOW(),30),SUBTIME(NOW(),'1:1:3'),DATEDIFF(NOW(),'2022-2-26'),
       TIMEDIFF(NOW(),'2022-2-26 20:06:52'),FROM_DAYS(366),TO_DAYS('0000-12-25'),
       LAST_DAY(NOW()),MAKEDATE(YEAR(NOW()),12),MAKETIME(10,21,23),PERIOD_ADD(20200101010101,10)
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./b6a1b7646f7a4f689d56011cc0566e1b.png"
        data-srcset="./b6a1b7646f7a4f689d56011cc0566e1b.png, ./b6a1b7646f7a4f689d56011cc0566e1b.png 1.5x, ./b6a1b7646f7a4f689d56011cc0566e1b.png 2x"
        data-sizes="auto"
        alt="./b6a1b7646f7a4f689d56011cc0566e1b.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT ADDTIME(NOW(),50); #当期时间加50秒
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./e82ac2c574754169a6ccd6b6ed9d1994.png"
        data-srcset="./e82ac2c574754169a6ccd6b6ed9d1994.png, ./e82ac2c574754169a6ccd6b6ed9d1994.png 1.5x, ./e82ac2c574754169a6ccd6b6ed9d1994.png 2x"
        data-sizes="auto"
        alt="./e82ac2c574754169a6ccd6b6ed9d1994.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT ADDTIME(NOW(),'1:1:1'); #当前时间加1小时1分钟1秒
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./737d3dfa22ca46aabe22118d4c76dc6b.png"
        data-srcset="./737d3dfa22ca46aabe22118d4c76dc6b.png, ./737d3dfa22ca46aabe22118d4c76dc6b.png 1.5x, ./737d3dfa22ca46aabe22118d4c76dc6b.png 2x"
        data-sizes="auto"
        alt="./737d3dfa22ca46aabe22118d4c76dc6b.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT SUBTIME(NOW(),'1:1:1'); #当前时间减1小时1分钟1秒
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./ceabd8f6c1ff4d94aa677bd08bbc59a3.png"
        data-srcset="./ceabd8f6c1ff4d94aa677bd08bbc59a3.png, ./ceabd8f6c1ff4d94aa677bd08bbc59a3.png 1.5x, ./ceabd8f6c1ff4d94aa677bd08bbc59a3.png 2x"
        data-sizes="auto"
        alt="./ceabd8f6c1ff4d94aa677bd08bbc59a3.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT SUBTIME(NOW(), '-1:-1:-1');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./9efc898eed13430b8e76541211974baf.png"
        data-srcset="./9efc898eed13430b8e76541211974baf.png, ./9efc898eed13430b8e76541211974baf.png 1.5x, ./9efc898eed13430b8e76541211974baf.png 2x"
        data-sizes="auto"
        alt="./9efc898eed13430b8e76541211974baf.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT FROM_DAYS(366);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./fdc0ab1da5894dc498cf1aaab903f361.png"
        data-srcset="./fdc0ab1da5894dc498cf1aaab903f361.png, ./fdc0ab1da5894dc498cf1aaab903f361.png 1.5x, ./fdc0ab1da5894dc498cf1aaab903f361.png 2x"
        data-sizes="auto"
        alt="./fdc0ab1da5894dc498cf1aaab903f361.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT MAKEDATE(2022,1);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./ed35dd1ec14a4e01a1dee202f3c9e3a3.png"
        data-srcset="./ed35dd1ec14a4e01a1dee202f3c9e3a3.png, ./ed35dd1ec14a4e01a1dee202f3c9e3a3.png 1.5x, ./ed35dd1ec14a4e01a1dee202f3c9e3a3.png 2x"
        data-sizes="auto"
        alt="./ed35dd1ec14a4e01a1dee202f3c9e3a3.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT MAKETIME(1,1,1);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./900b7a90db0940ac9833f168165a67e6.png"
        data-srcset="./900b7a90db0940ac9833f168165a67e6.png, ./900b7a90db0940ac9833f168165a67e6.png 1.5x, ./900b7a90db0940ac9833f168165a67e6.png 2x"
        data-sizes="auto"
        alt="./900b7a90db0940ac9833f168165a67e6.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT PERIOD_ADD(20200101010101,1);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./eb5239c0ab7b495982a8b6688eba7027.png"
        data-srcset="./eb5239c0ab7b495982a8b6688eba7027.png, ./eb5239c0ab7b495982a8b6688eba7027.png 1.5x, ./eb5239c0ab7b495982a8b6688eba7027.png 2x"
        data-sizes="auto"
        alt="./eb5239c0ab7b495982a8b6688eba7027.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT TO_DAYS(NOW());
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./c7bdb33bf68b47bd984d0214884a4312.png"
        data-srcset="./c7bdb33bf68b47bd984d0214884a4312.png, ./c7bdb33bf68b47bd984d0214884a4312.png 1.5x, ./c7bdb33bf68b47bd984d0214884a4312.png 2x"
        data-sizes="auto"
        alt="./c7bdb33bf68b47bd984d0214884a4312.png"
        title="在这里插入图片描述" /></p>
<h1 id="查询-7-天内的新增用户数有多少">查询 7 天内的新增用户数有多少？</h1>
<pre><code>SELECT COUNT(*) AS num FROM new_user WHERE TO_DAYS(NOW())-TO_DAYS(regist_time)&lt;=7
</code></pre>
<h2 id="2-日期的格式化与解析">2 日期的格式化与解析</h2>
<p>函数</p>
<p>用法</p>
<p>DATE_FORMAT(date,fmt)</p>
<p>按照字符串fmt格式化日期date值</p>
<p>TIME_FORMAT(time,fmt)</p>
<p>按照字符串fmt格式化时间time值</p>
<p>GET_FORMAT(date_type,format_type)</p>
<p>返回日期字符串的显示格式</p>
<p>STR_TO_DATE(str, fmt)</p>
<p>按照字符串fmt对str进行解析，解析为一个日期</p>
<p>上述非GET_FORMAT函数中fmt参数常用的格式符：</p>
<p>格式符</p>
<p>说明</p>
<p>格式符</p>
<p>说明</p>
<p>%Y</p>
<p>4位数字表示年份</p>
<p>%y</p>
<p>表示两位数字表示年份</p>
<p>%M</p>
<p>月名表示月份(January,…)</p>
<p>%m</p>
<p>两位数字表示月份(01,02,03。。。)</p>
<p>%b</p>
<p>缩写的月名(Jan.，Feb.，…)</p>
<p>%c</p>
<p>数字表示月份(1,2,3,…)</p>
<p>%D</p>
<p>英文后缀表示月中的天数(1st,2nd,3rd,…)</p>
<p>%d</p>
<p>两位数字表示月中的天数(01,02…)</p>
<p>%e</p>
<p>数字形式表示月中的天数(1,2,3,4,5…)</p>
<p>%H</p>
<p>两位数字表示小数，24小时制(01,02…)</p>
<p>%h和%I</p>
<p>两位数字表示小时，12小时制(01,02…)</p>
<p>%k</p>
<p>数字形式的小时，24小时制(1,2,3)</p>
<p>%l</p>
<p>数字形式表示小时，12小时制(1,2,3,4…)</p>
<p>%i</p>
<p>两位数字表示分钟(00,01,02)</p>
<p>%S和%s</p>
<p>两位数字表示秒(00,01,02…)</p>
<p>%W</p>
<p>一周中的星期名称(Sunday…)</p>
<p>%a</p>
<p>一周中的星期缩写(Sun.，Mon.,Tues.，…)</p>
<p>%w</p>
<p>以数字表示周中的天数(0=Sunday,1=Monday…)</p>
<p>%j</p>
<p>以3位数字表示年中的天数(001,002…)</p>
<p>%U</p>
<p>以数字表示年中的第几周，(1,2,3。。)其中Sunday为周中第一天</p>
<p>%u</p>
<p>以数字表示年中的第几周，(1,2,3。。)其中Monday为周中第一天</p>
<p>%T</p>
<p>24小时制</p>
<p>%r</p>
<p>12小时制</p>
<p>%p</p>
<p>AM或PM</p>
<p>%%</p>
<p>表示%</p>
<p>GET_FORMAT函数中date_type和format_type参数取值如下：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-3240356.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-3240356.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-3240356.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-3240356.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-3240356.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT DATE_FORMAT(NOW(), '%H:%i:%s');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./b0a32727980f4964badc1c2acd75bb20.png"
        data-srcset="./b0a32727980f4964badc1c2acd75bb20.png, ./b0a32727980f4964badc1c2acd75bb20.png 1.5x, ./b0a32727980f4964badc1c2acd75bb20.png 2x"
        data-sizes="auto"
        alt="./b0a32727980f4964badc1c2acd75bb20.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT STR_TO_DATE('09/01/2009','%m/%d/%Y')
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./0cacd611aeee41129e022d7dee5646ee.png"
        data-srcset="./0cacd611aeee41129e022d7dee5646ee.png, ./0cacd611aeee41129e022d7dee5646ee.png 1.5x, ./0cacd611aeee41129e022d7dee5646ee.png 2x"
        data-sizes="auto"
        alt="./0cacd611aeee41129e022d7dee5646ee.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT STR_TO_DATE('20140422154706','%Y%m%d%H%i%s')
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./e6e53a54896c4cb7b6734369f2230622.png"
        data-srcset="./e6e53a54896c4cb7b6734369f2230622.png, ./e6e53a54896c4cb7b6734369f2230622.png 1.5x, ./e6e53a54896c4cb7b6734369f2230622.png 2x"
        data-sizes="auto"
        alt="./e6e53a54896c4cb7b6734369f2230622.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT STR_TO_DATE('2014-04-22 15:47:06','%Y-%m-%d %H:%i:%s')
FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./72bc357a74604c76a750992b74519a45.png"
        data-srcset="./72bc357a74604c76a750992b74519a45.png, ./72bc357a74604c76a750992b74519a45.png 1.5x, ./72bc357a74604c76a750992b74519a45.png 2x"
        data-sizes="auto"
        alt="./72bc357a74604c76a750992b74519a45.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT GET_FORMAT(DATE, 'USA');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./573c9396b7694572886270af9d5d88d8.png"
        data-srcset="./573c9396b7694572886270af9d5d88d8.png, ./573c9396b7694572886270af9d5d88d8.png 1.5x, ./573c9396b7694572886270af9d5d88d8.png 2x"
        data-sizes="auto"
        alt="./573c9396b7694572886270af9d5d88d8.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT DATE_FORMAT(NOW(),GET_FORMAT(DATE,'USA')) FROM DUAL;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./611ca03eee20413084b582eadde75aa7.png"
        data-srcset="./611ca03eee20413084b582eadde75aa7.png, ./611ca03eee20413084b582eadde75aa7.png 1.5x, ./611ca03eee20413084b582eadde75aa7.png 2x"
        data-sizes="auto"
        alt="./611ca03eee20413084b582eadde75aa7.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT STR_TO_DATE('2020-01-01 00:00:00','%Y-%m-%d');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./90b532ad482047f894c3a99e5f9035d3.png"
        data-srcset="./90b532ad482047f894c3a99e5f9035d3.png, ./90b532ad482047f894c3a99e5f9035d3.png 1.5x, ./90b532ad482047f894c3a99e5f9035d3.png 2x"
        data-sizes="auto"
        alt="./90b532ad482047f894c3a99e5f9035d3.png"
        title="在这里插入图片描述" /></p>
<h2 id="75-流程控制函数">7.5 流程控制函数</h2>
<blockquote>
<p>流程处理函数可以根据不同的条件，执行不同的处理流程，可以在SQL语句中实现不同的条件选择。MySQL中的流程处理函数主要包括IF()、IFNULL()和CASE()函数。</p>
</blockquote>
<p>函数</p>
<p>用法</p>
<p>IF(value,value1,value2)</p>
<p>如果value的值为TRUE，返回value1，否则返回value2</p>
<p>IFNULL(value1, value2)</p>
<p>如果value1不为NULL，返回value1，否则返回value2</p>
<p>CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2 … [ELSE resultn] END</p>
<p>相当于Java的if…else if…else…</p>
<p>CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN 值1 … [ELSE 值n] END</p>
<p>相当于Java的switch…case…</p>
<pre><code>SELECT IF(1&gt;0,'正确','错误')
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./041fe748a5c2449eb44f06a104c2fddc.png"
        data-srcset="./041fe748a5c2449eb44f06a104c2fddc.png, ./041fe748a5c2449eb44f06a104c2fddc.png 1.5x, ./041fe748a5c2449eb44f06a104c2fddc.png 2x"
        data-sizes="auto"
        alt="./041fe748a5c2449eb44f06a104c2fddc.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT IFNULL(NULL,'Hello Word');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./85a2986aed5e4c16ab294045b21877b1.png"
        data-srcset="./85a2986aed5e4c16ab294045b21877b1.png, ./85a2986aed5e4c16ab294045b21877b1.png 1.5x, ./85a2986aed5e4c16ab294045b21877b1.png 2x"
        data-sizes="auto"
        alt="./85a2986aed5e4c16ab294045b21877b1.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT CASE WHEN 1 &gt; 0 THEN '1&gt;0'
            WHEN 2 &gt; 0 THEN '2&gt;0'
       ELSE '3 &gt; 0'
       END;


SELECT employee_id,salary, CASE WHEN salary&gt;=15000 THEN '高薪'
				  WHEN salary&gt;=10000 THEN '潜力股'
				  WHEN salary&gt;=8000 THEN '屌丝'
				  ELSE '草根' END  &quot;描述&quot;
FROM employees;
SELECT oid,`status`, CASE `status` WHEN 1 THEN '未付款'
								   WHEN 2 THEN '已付款'
								   WHEN 3 THEN '已发货'
								   WHEN 4 THEN '确认收货'
								   ELSE '无效订单' END
FROM t_order;
</code></pre>
<h2 id="76-流程控制函数">7.6 流程控制函数</h2>
<blockquote>
<p>加密与解密函数主要用于对数据库中的数据进行加密和解密处理，以防止数据被他人窃取。这些函数在保证数据库安全时非常有用。</p>
</blockquote>
<p>函数</p>
<p>用法</p>
<p>PASSWORD(str)</p>
<p>返回字符串str的加密版本，41位长的字符串。加密结果不可逆，常用于用户的密码加密</p>
<p>MD5(str)</p>
<p>返回字符串str的md5加密后的值，也是一种加密方式。若参数为NULL，则会返回NULL</p>
<p>SHA(str)</p>
<p>从原明文密码str计算并返回加密后的密码字符串，当参数为NULL时，返回NULL。SHA加密算法比MD5更加安全。</p>
<p>ENCODE(value,password_seed)</p>
<p>返回使用password_seed作为加密密码加密value</p>
<p>DECODE(value,password_seed)</p>
<p>返回使用password_seed作为加密密码解密value</p>
<blockquote>
<p>可以看到，ENCODE(value,password_seed)函数与DECODE(value,password_seed)函数互为反函数。</p>
</blockquote>
<pre><code>mysql&gt; SELECT PASSWORD('mysql'), PASSWORD(NULL);
+-------------------------------------------+----------------+
| PASSWORD('mysql')                         | PASSWORD(NULL) |
+-------------------------------------------+----------------+
| *E74858DB86EBA20BC33D0AECAE8A8108C56B17FA |                |
+-------------------------------------------+----------------+
1 row in set, 1 warning (0.00 sec)


SELECT md5('123')
-&gt;202cb962ac59075b964b07152d234b70


SELECT SHA('Tom123')
-&gt;c7c506980abc31cc390a2438c90861d0f1216d50


mysql&gt; SELECT ENCODE('mysql', 'mysql');
+--------------------------+
| ENCODE('mysql', 'mysql') |
+--------------------------+
| íg　¼　ìÉ                  |
+--------------------------+
1 row in set, 1 warning (0.01 sec)


mysql&gt; SELECT DECODE(ENCODE('mysql','mysql'),'mysql');
+-----------------------------------------+
| DECODE(ENCODE('mysql','mysql'),'mysql') |
+-----------------------------------------+
| mysql                                   |
+-----------------------------------------+
1 row in set, 2 warnings (0.00 sec)
</code></pre>
<h2 id="77-mysql信息函数">7.7 MySQL信息函数</h2>
<blockquote>
<p>MySQL中内置了一些可以查询MySQL信息的函数，这些函数主要用于帮助数据库开发或运维人员更好地对数据库进行维护工作。</p>
</blockquote>
<p>函数</p>
<p>用法</p>
<p>VERSION()</p>
<p>返回当前MySQL的版本号</p>
<p>CONNECTION_ID()</p>
<p>返回当前MySQL服务器的连接数</p>
<p>DATABASE()，SCHEMA()</p>
<p>返回MySQL命令行当前所在的数据库</p>
<p>USER()，CURRENT_USER()、SYSTEM_USER()，SESSION_USER()</p>
<p>返回当前连接MySQL的用户名，返回结果格式为“主机名@用户名”</p>
<p>CHARSET(value)</p>
<p>返回字符串value自变量的字符集</p>
<p>COLLATION(value)</p>
<p>返回字符串value的比较规则</p>
<pre><code> SELECT DATABASE();
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./92178882cd3040e3904289bcc1562749.png"
        data-srcset="./92178882cd3040e3904289bcc1562749.png, ./92178882cd3040e3904289bcc1562749.png 1.5x, ./92178882cd3040e3904289bcc1562749.png 2x"
        data-sizes="auto"
        alt="./92178882cd3040e3904289bcc1562749.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT USER(), CURRENT_USER(), SYSTEM_USER(),SESSION_USER();
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./f72ddc523ec24db78ecfae7fa2860758.png"
        data-srcset="./f72ddc523ec24db78ecfae7fa2860758.png, ./f72ddc523ec24db78ecfae7fa2860758.png 1.5x, ./f72ddc523ec24db78ecfae7fa2860758.png 2x"
        data-sizes="auto"
        alt="./f72ddc523ec24db78ecfae7fa2860758.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT CHARSET('ABC');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./3376496e1a9e4e629853646ba6ab2371.png"
        data-srcset="./3376496e1a9e4e629853646ba6ab2371.png, ./3376496e1a9e4e629853646ba6ab2371.png 1.5x, ./3376496e1a9e4e629853646ba6ab2371.png 2x"
        data-sizes="auto"
        alt="./3376496e1a9e4e629853646ba6ab2371.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT COLLATION('ABC');
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./38001c9a4f724e09b661acb54ebbb836.png"
        data-srcset="./38001c9a4f724e09b661acb54ebbb836.png, ./38001c9a4f724e09b661acb54ebbb836.png 1.5x, ./38001c9a4f724e09b661acb54ebbb836.png 2x"
        data-sizes="auto"
        alt="./38001c9a4f724e09b661acb54ebbb836.png"
        title="在这里插入图片描述" /></p>
<h2 id="78-其他函数">7.8 其他函数</h2>
<blockquote>
<p>MySQL中有些函数无法对其进行具体的分类，但是这些函数在MySQL的开发和运维过程中也是不容忽视的。</p>
</blockquote>
<p>函数</p>
<p>用法</p>
<p>FORMAT(value,n)</p>
<p>返回对数字value进行格式化后的结果数据。n表示四舍五入后保留到小数点后n位</p>
<p>CONV(value,from,to)</p>
<p>将value的值进行不同进制之间的转换</p>
<p>INET_ATON(ipvalue)</p>
<p>将以点分隔的IP地址转化为一个数字</p>
<p>INET_NTOA(value)</p>
<p>将数字形式的IP地址转化为以点分隔的IP地址</p>
<p>BENCHMARK(n,expr)</p>
<p>将表达式expr重复执行n次。用于测试MySQL处理expr表达式所耗费的时间</p>
<p>CONVERT(value USING char_code)</p>
<p>将value所使用的字符编码修改为char_code</p>
<h1 id="如果n的值小于或者等于0则只保留整数部分">如果n的值小于或者等于0，则只保留整数部分</h1>
<pre><code>SELECT FORMAT(123.123, 2), FORMAT(123.523, 0), FORMAT(123.123, -2);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./149bcd03c4c74914a75b02f7cba35dd4.png"
        data-srcset="./149bcd03c4c74914a75b02f7cba35dd4.png, ./149bcd03c4c74914a75b02f7cba35dd4.png 1.5x, ./149bcd03c4c74914a75b02f7cba35dd4.png 2x"
        data-sizes="auto"
        alt="./149bcd03c4c74914a75b02f7cba35dd4.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT CONV(16, 10, 2), CONV(8888,10,16), CONV(NULL, 10, 2);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./7f35906c0ca04cd9b450cc4fc63c8078.png"
        data-srcset="./7f35906c0ca04cd9b450cc4fc63c8078.png, ./7f35906c0ca04cd9b450cc4fc63c8078.png 1.5x, ./7f35906c0ca04cd9b450cc4fc63c8078.png 2x"
        data-sizes="auto"
        alt="./7f35906c0ca04cd9b450cc4fc63c8078.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT INET_ATON('192.168.1.100');
</code></pre>
<h1 id="以1921681100为例计算方式为192乘以256的3次方加上168乘以256的2次方加上1乘以256再加上100">以“192.168.1.100”为例，计算方式为192乘以256的3次方，加上168乘以256的2次方，加上1乘以256，再加上100。</h1>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./27a2424ee0bd4998895fdbfab5d5f7ae.png"
        data-srcset="./27a2424ee0bd4998895fdbfab5d5f7ae.png, ./27a2424ee0bd4998895fdbfab5d5f7ae.png 1.5x, ./27a2424ee0bd4998895fdbfab5d5f7ae.png 2x"
        data-sizes="auto"
        alt="./27a2424ee0bd4998895fdbfab5d5f7ae.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT INET_NTOA(3232235876);
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./15e49d139fd54125b9607dad465e0403.png"
        data-srcset="./15e49d139fd54125b9607dad465e0403.png, ./15e49d139fd54125b9607dad465e0403.png 1.5x, ./15e49d139fd54125b9607dad465e0403.png 2x"
        data-sizes="auto"
        alt="./15e49d139fd54125b9607dad465e0403.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT BENCHMARK(1, MD5('mysql'));
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./5cca5d9899094724addd192ff3fb74f9.png"
        data-srcset="./5cca5d9899094724addd192ff3fb74f9.png, ./5cca5d9899094724addd192ff3fb74f9.png 1.5x, ./5cca5d9899094724addd192ff3fb74f9.png 2x"
        data-sizes="auto"
        alt="./5cca5d9899094724addd192ff3fb74f9.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT BENCHMARK(1000000, MD5('mysql'));
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./94644cc54380410c9b208ab1e6a5ad3f.png"
        data-srcset="./94644cc54380410c9b208ab1e6a5ad3f.png, ./94644cc54380410c9b208ab1e6a5ad3f.png 1.5x, ./94644cc54380410c9b208ab1e6a5ad3f.png 2x"
        data-sizes="auto"
        alt="./94644cc54380410c9b208ab1e6a5ad3f.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT CHARSET('mysql'), CHARSET(CONVERT('mysql' USING 'utf8'));
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./2a542413a53d4981bb913f3f5a3aea65.png"
        data-srcset="./2a542413a53d4981bb913f3f5a3aea65.png, ./2a542413a53d4981bb913f3f5a3aea65.png 1.5x, ./2a542413a53d4981bb913f3f5a3aea65.png 2x"
        data-sizes="auto"
        alt="./2a542413a53d4981bb913f3f5a3aea65.png"
        title="在这里插入图片描述" /></p>
<h2 id="3-练习sql">3 练习sql</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">第</span><span class="mi">07</span><span class="err">章</span><span class="n">_</span><span class="err">单行函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">数值函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">基本的操作</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">ABS</span><span class="p">(</span><span class="o">-</span><span class="mi">123</span><span class="p">),</span><span class="k">ABS</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span><span class="n">SIGN</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">),</span><span class="n">SIGN</span><span class="p">(</span><span class="mi">43</span><span class="p">),</span><span class="n">PI</span><span class="p">(),</span><span class="n">CEIL</span><span class="p">(</span><span class="mi">32</span><span class="p">.</span><span class="mi">32</span><span class="p">),</span><span class="n">CEILING</span><span class="p">(</span><span class="o">-</span><span class="mi">43</span><span class="p">.</span><span class="mi">23</span><span class="p">),</span><span class="n">FLOOR</span><span class="p">(</span><span class="mi">32</span><span class="p">.</span><span class="mi">32</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FLOOR</span><span class="p">(</span><span class="o">-</span><span class="mi">43</span><span class="p">.</span><span class="mi">23</span><span class="p">),</span><span class="k">MOD</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">12</span><span class="w"> </span><span class="k">MOD</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">取随机数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">RAND</span><span class="p">(),</span><span class="n">RAND</span><span class="p">(),</span><span class="n">RAND</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">RAND</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">RAND</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">RAND</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">四舍五入，截断操作</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">556</span><span class="p">),</span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ROUND</span><span class="p">(</span><span class="mi">153</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">TRUNCATE</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="k">TRUNCATE</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">496</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="k">TRUNCATE</span><span class="p">(</span><span class="mi">129</span><span class="p">.</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">单行函数可以嵌套</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">TRUNCATE</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">456</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">角度与弧度的互换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DEGREES</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">()),</span><span class="n">DEGREES</span><span class="p">(</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">三角函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">SIN</span><span class="p">(</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">30</span><span class="p">)),</span><span class="n">DEGREES</span><span class="p">(</span><span class="n">ASIN</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">TAN</span><span class="p">(</span><span class="n">RADIANS</span><span class="p">(</span><span class="mi">45</span><span class="p">)),</span><span class="n">DEGREES</span><span class="p">(</span><span class="n">ATAN</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">指数和对数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">POW</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">POWER</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">EXP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">LN</span><span class="p">(</span><span class="n">EXP</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">LOG</span><span class="p">(</span><span class="n">EXP</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">LOG10</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">LOG2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">进制间的转换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">BIN</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">HEX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">OCT</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">CONV</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">字符串函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ASCII</span><span class="p">(</span><span class="s1">&#39;Abcdfsf&#39;</span><span class="p">),</span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">),</span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;我们&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LENGTH</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">),</span><span class="k">LENGTH</span><span class="p">(</span><span class="s1">&#39;我们&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">xxx</span><span class="w"> </span><span class="n">worked</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">yyy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="n">emp</span><span class="p">.</span><span class="n">last_name</span><span class="p">,</span><span class="s1">&#39; worked for &#39;</span><span class="p">,</span><span class="n">mgr</span><span class="p">.</span><span class="n">last_name</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="n">mgr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="o">`</span><span class="n">manager_id</span><span class="o">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="p">.</span><span class="n">employee_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONCAT_WS</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;world&#39;</span><span class="p">,</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;beijing&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">字符串的索引是从</span><span class="mi">1</span><span class="err">开始的！</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">INSERT</span><span class="p">(</span><span class="s1">&#39;helloworld&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">),</span><span class="k">REPLACE</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="s1">&#39;lol&#39;</span><span class="p">,</span><span class="s1">&#39;mmm&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">UPPER</span><span class="p">(</span><span class="s1">&#39;HelLo&#39;</span><span class="p">),</span><span class="k">LOWER</span><span class="p">(</span><span class="s1">&#39;HelLo&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="n">last_name</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;King&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="k">RIGHT</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="k">RIGHT</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">LPAD</span><span class="p">:</span><span class="err">实现右对齐效果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">RPAD</span><span class="p">:</span><span class="err">实现左对齐效果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="n">LPAD</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">,</span><span class="n">LTRIM</span><span class="p">(</span><span class="s1">&#39;    h  el  lo   &#39;</span><span class="p">),</span><span class="s1">&#39;***&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">TRIM</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;ooheollo&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">REPEAT</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="k">LENGTH</span><span class="p">(</span><span class="k">SPACE</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span><span class="n">STRCMP</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="s1">&#39;abe&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">SUBSTR</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">LOCATE</span><span class="p">(</span><span class="s1">&#39;lll&#39;</span><span class="p">,</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ELT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">),</span><span class="n">FIELD</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span><span class="s1">&#39;gg&#39;</span><span class="p">,</span><span class="s1">&#39;jj&#39;</span><span class="p">,</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span><span class="s1">&#39;mm&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FIND_IN_SET</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span><span class="s1">&#39;gg,mm,jj,dd,mm,gg&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="k">NULLIF</span><span class="p">(</span><span class="k">LENGTH</span><span class="p">(</span><span class="n">first_name</span><span class="p">),</span><span class="k">LENGTH</span><span class="p">(</span><span class="n">last_name</span><span class="p">))</span><span class="w"> </span><span class="s2">&#34;compare&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">日期和时间函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">获取日期、时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">(),</span><span class="k">CURRENT_DATE</span><span class="p">(),</span><span class="n">CURTIME</span><span class="p">(),</span><span class="n">NOW</span><span class="p">(),</span><span class="n">SYSDATE</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">UTC_DATE</span><span class="p">(),</span><span class="n">UTC_TIME</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">(),</span><span class="n">CURDATE</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">CURTIME</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">NOW</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">日期与时间戳的转换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">UNIX_TIMESTAMP</span><span class="p">(),</span><span class="n">UNIX_TIMESTAMP</span><span class="p">(</span><span class="s1">&#39;2021-10-01 12:12:32&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FROM_UNIXTIME</span><span class="p">(</span><span class="mi">1635173853</span><span class="p">),</span><span class="n">FROM_UNIXTIME</span><span class="p">(</span><span class="mi">1633061552</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">获取月份、星期、星期数、天数等函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">()),</span><span class="k">MONTH</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">()),</span><span class="k">DAY</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">HOUR</span><span class="p">(</span><span class="n">CURTIME</span><span class="p">()),</span><span class="k">MINUTE</span><span class="p">(</span><span class="n">NOW</span><span class="p">()),</span><span class="k">SECOND</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">MONTHNAME</span><span class="p">(</span><span class="s1">&#39;2021-10-26&#39;</span><span class="p">),</span><span class="n">DAYNAME</span><span class="p">(</span><span class="s1">&#39;2021-10-26&#39;</span><span class="p">),</span><span class="n">WEEKDAY</span><span class="p">(</span><span class="s1">&#39;2021-10-26&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">QUARTER</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">()),</span><span class="n">WEEK</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">()),</span><span class="n">DAYOFYEAR</span><span class="p">(</span><span class="n">NOW</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DAYOFMONTH</span><span class="p">(</span><span class="n">NOW</span><span class="p">()),</span><span class="n">DAYOFWEEK</span><span class="p">(</span><span class="n">NOW</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">日期的操作函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">SECOND</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">NOW</span><span class="p">()),</span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">DAY</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">NOW</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">HOUR_MINUTE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">NOW</span><span class="p">()),</span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">QUARTER</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;2021-05-12&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">时间和秒钟转换的函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">TIME_TO_SEC</span><span class="p">(</span><span class="n">CURTIME</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SEC_TO_TIME</span><span class="p">(</span><span class="mi">83355</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">计算日期和时间的函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">NOW</span><span class="p">(),</span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">YEAR</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">YEAR</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_SUB</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">&#39;2021-10-21 23:32:12&#39;</span><span class="p">,</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ADDDATE</span><span class="p">(</span><span class="s1">&#39;2021-10-21 23:32:12&#39;</span><span class="p">,</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">SECOND</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col3</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">&#39;2021-10-21 23:32:12&#39;</span><span class="p">,</span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1_1&#39;</span><span class="w"> </span><span class="n">MINUTE_SECOND</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">YEAR</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col5</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="err">可以是负数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="s1">&#39;1_1&#39;</span><span class="w"> </span><span class="n">YEAR_MONTH</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col6</span><span class="w"> </span><span class="o">#</span><span class="err">需要单引号</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ADDTIME</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="mi">20</span><span class="p">),</span><span class="n">SUBTIME</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="mi">30</span><span class="p">),</span><span class="n">SUBTIME</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="s1">&#39;1:1:3&#39;</span><span class="p">),</span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="s1">&#39;2021-10-01&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TIMEDIFF</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="s1">&#39;2021-10-25 22:10:10&#39;</span><span class="p">),</span><span class="n">FROM_DAYS</span><span class="p">(</span><span class="mi">366</span><span class="p">),</span><span class="n">TO_DAYS</span><span class="p">(</span><span class="s1">&#39;0000-12-25&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">LAST_DAY</span><span class="p">(</span><span class="n">NOW</span><span class="p">()),</span><span class="n">MAKEDATE</span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="n">NOW</span><span class="p">()),</span><span class="mi">32</span><span class="p">),</span><span class="n">MAKETIME</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">PERIOD_ADD</span><span class="p">(</span><span class="mi">20200101010101</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">日期的格式化与解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">格式化：日期</span><span class="w"> </span><span class="c1">---&gt; 字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">#</span><span class="w"> </span><span class="err">解析：</span><span class="w">  </span><span class="err">字符串</span><span class="w"> </span><span class="c1">----&gt; 日期
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">此时我们谈的是日期的显式格式化和解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">之前，我们接触过隐式的格式化或解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">hire_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1993-01-13&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">格式化：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">(),</span><span class="s1">&#39;%Y-%M-%D&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">),</span><span class="n">TIME_FORMAT</span><span class="p">(</span><span class="n">CURTIME</span><span class="p">(),</span><span class="s1">&#39;%h:%i:%S&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span><span class="s1">&#39;%Y-%M-%D %h:%i:%S %W %w %T %r&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">解析：格式化的逆过程</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">STR_TO_DATE</span><span class="p">(</span><span class="s1">&#39;2021-October-25th 11:37:30 Monday 1&#39;</span><span class="p">,</span><span class="s1">&#39;%Y-%M-%D %h:%i:%S %W %w&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">GET_FORMAT</span><span class="p">(</span><span class="nb">DATE</span><span class="p">,</span><span class="s1">&#39;USA&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">(),</span><span class="n">GET_FORMAT</span><span class="p">(</span><span class="nb">DATE</span><span class="p">,</span><span class="s1">&#39;USA&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">流程控制函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">VALUE</span><span class="p">,</span><span class="n">VALUE1</span><span class="p">,</span><span class="n">VALUE2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="k">IF</span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">6000</span><span class="p">,</span><span class="s1">&#39;高工资&#39;</span><span class="p">,</span><span class="s1">&#39;低工资&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">commission_pct</span><span class="p">,</span><span class="k">IF</span><span class="p">(</span><span class="n">commission_pct</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="n">commission_pct</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">commission_pct</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="n">commission_pct</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="s2">&#34;annual_sal&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">IFNULL</span><span class="p">(</span><span class="n">VALUE1</span><span class="p">,</span><span class="n">VALUE2</span><span class="p">):</span><span class="err">看做是</span><span class="k">IF</span><span class="p">(</span><span class="n">VALUE</span><span class="p">,</span><span class="n">VALUE1</span><span class="p">,</span><span class="n">VALUE2</span><span class="p">)</span><span class="err">的特殊情况</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">commission_pct</span><span class="p">,</span><span class="n">IFNULL</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="p">...</span><span class="k">WHEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">END</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">类似于</span><span class="n">java</span><span class="err">的</span><span class="k">if</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">else</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">15000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;白骨精&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;潜力股&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">8000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;小屌丝&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;草根&#39;</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="p">,</span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">15000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;白骨精&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;潜力股&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">WHEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">8000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;小屌丝&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			     </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">END</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">类似于</span><span class="n">java</span><span class="err">的</span><span class="n">swich</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">case</span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">练习1
</span></span></span><span class="line"><span class="cl"><span class="cm">查询部门号为 10,20, 30 的员工信息,
</span></span></span><span class="line"><span class="cl"><span class="cm">若部门号为 10, 则打印其工资的 1.1 倍,
</span></span></span><span class="line"><span class="cl"><span class="cm">20 号部门, 则打印其工资的 1.2 倍,
</span></span></span><span class="line"><span class="cl"><span class="cm">30 号部门,打印其工资的 1.3 倍数,
</span></span></span><span class="line"><span class="cl"><span class="cm">其他部门,打印其工资的 1.4 倍数
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="n">department_id</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">ELSE</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">练习2
</span></span></span><span class="line"><span class="cl"><span class="cm">查询部门号为 10,20, 30 的员工信息,
</span></span></span><span class="line"><span class="cl"><span class="cm">若部门号为 10, 则打印其工资的 1.1 倍,
</span></span></span><span class="line"><span class="cl"><span class="cm">20 号部门, 则打印其工资的 1.2 倍,
</span></span></span><span class="line"><span class="cl"><span class="cm">30 号部门打印其工资的 1.3 倍数
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="n">department_id</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								     </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;details&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">加密与解密的函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">PASSWORD</span><span class="p">()</span><span class="err">在</span><span class="n">mysql8</span><span class="p">.</span><span class="mi">0</span><span class="err">中弃用。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">MD5</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">),</span><span class="n">SHA</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">),</span><span class="n">MD5</span><span class="p">(</span><span class="n">MD5</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">ENCODE</span><span class="p">()</span><span class="err">\</span><span class="n">DECODE</span><span class="p">()</span><span class="w"> </span><span class="err">在</span><span class="n">mysql8</span><span class="p">.</span><span class="mi">0</span><span class="err">中弃用。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">SELECT ENCODE(&#39;atguigu&#39;,&#39;mysql&#39;),DECODE(ENCODE(&#39;atguigu&#39;,&#39;mysql&#39;),&#39;mysql&#39;)
</span></span></span><span class="line"><span class="cl"><span class="cm">FROM DUAL;
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">MySQL</span><span class="err">信息函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">VERSION</span><span class="p">(),</span><span class="n">CONNECTION_ID</span><span class="p">(),</span><span class="k">DATABASE</span><span class="p">(),</span><span class="k">SCHEMA</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">USER</span><span class="p">(),</span><span class="k">CURRENT_USER</span><span class="p">(),</span><span class="n">CHARSET</span><span class="p">(</span><span class="s1">&#39;尚硅谷&#39;</span><span class="p">),</span><span class="k">COLLATION</span><span class="p">(</span><span class="s1">&#39;尚硅谷&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">其他函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">如果</span><span class="n">n</span><span class="err">的值小于或者等于</span><span class="mi">0</span><span class="err">，则只保留整数部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">FORMAT</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">125</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">FORMAT</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">125</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">FORMAT</span><span class="p">(</span><span class="mi">123</span><span class="p">.</span><span class="mi">125</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONV</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">CONV</span><span class="p">(</span><span class="mi">8888</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="n">CONV</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">以“</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">100</span><span class="err">”为例，计算方式为</span><span class="mi">192</span><span class="err">乘以</span><span class="mi">256</span><span class="err">的</span><span class="mi">3</span><span class="err">次方，加上</span><span class="mi">168</span><span class="err">乘以</span><span class="mi">256</span><span class="err">的</span><span class="mi">2</span><span class="err">次方，加上</span><span class="mi">1</span><span class="err">乘以</span><span class="mi">256</span><span class="err">，再加上</span><span class="mi">100</span><span class="err">。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">INET_ATON</span><span class="p">(</span><span class="s1">&#39;192.168.1.100&#39;</span><span class="p">),</span><span class="n">INET_NTOA</span><span class="p">(</span><span class="mi">3232235876</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">BENCHMARK</span><span class="p">()</span><span class="err">用于测试表达式的执行效率</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">BENCHMARK</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span><span class="n">MD5</span><span class="p">(</span><span class="s1">&#39;mysql&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">CONVERT</span><span class="p">():</span><span class="err">可以实现字符集的转换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CHARSET</span><span class="p">(</span><span class="s1">&#39;atguigu&#39;</span><span class="p">),</span><span class="n">CHARSET</span><span class="p">(</span><span class="k">CONVERT</span><span class="p">(</span><span class="s1">&#39;atguigu&#39;</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="s1">&#39;gbk&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">第</span><span class="mi">07</span><span class="err">章</span><span class="n">_</span><span class="err">单行函数的课后练习</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">显示系统时间</span><span class="p">(</span><span class="err">注：日期</span><span class="o">+</span><span class="err">时间</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">NOW</span><span class="p">(),</span><span class="n">SYSDATE</span><span class="p">(),</span><span class="k">CURRENT_TIMESTAMP</span><span class="p">(),</span><span class="k">LOCALTIME</span><span class="p">(),</span><span class="k">LOCALTIMESTAMP</span><span class="p">()</span><span class="w"> </span><span class="o">#</span><span class="err">大家只需要掌握一个函数就可以了</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">DUAL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询员工号，姓名，工资，以及工资提高百分之</span><span class="mi">20</span><span class="o">%</span><span class="err">后的结果</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;new salary&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">将员工的姓名按首字母排序，并写出姓名的长度</span><span class="p">(</span><span class="k">length</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="k">LENGTH</span><span class="p">(</span><span class="n">last_name</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;name_length&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">last_name</span><span class="w"> </span><span class="k">asc</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name_length</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询员工</span><span class="n">id</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="n">salary</span><span class="err">，并作为一个列输出，别名为</span><span class="n">OUT_PUT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="n">employee_id</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">last_name</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;OUT_PUT&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询公司各员工工作的年数、工作的天数，并按工作年数的降序排序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">employee_id</span><span class="p">,</span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">(),</span><span class="n">hire_date</span><span class="p">)</span><span class="o">/</span><span class="mi">365</span><span class="w"> </span><span class="s2">&#34;worked_years&#34;</span><span class="p">,</span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">(),</span><span class="n">hire_date</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;worked_days&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TO_DAYS</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TO_DAYS</span><span class="p">(</span><span class="n">hire_date</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;worked_days1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">worked_years</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询员工姓名，</span><span class="n">hire_date</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">department_id</span><span class="err">，满足以下条件：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">雇用时间在</span><span class="mi">1997</span><span class="err">年之后，</span><span class="n">department_id</span><span class="w"> </span><span class="err">为</span><span class="mi">80</span><span class="w"> </span><span class="err">或</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="err">或</span><span class="mi">110</span><span class="p">,</span><span class="w"> </span><span class="n">commission_pct</span><span class="err">不为空</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">hire_date</span><span class="p">,</span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">110</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">commission_pct</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">hire_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;1997-01-01&#39;</span><span class="p">;</span><span class="w">  </span><span class="err">存在着隐式转换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">and</span><span class="w">  </span><span class="n">date_format</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;1997-01-01&#39;</span><span class="p">;</span><span class="w">   </span><span class="err">显式转换操作，格式化：日期</span><span class="c1">---&gt; 字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">#</span><span class="w"> </span><span class="k">and</span><span class="w">  </span><span class="n">date_format</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;1997&#39;</span><span class="p">;</span><span class="w">    </span><span class="err">显式转换操作，格式化</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">hire_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">STR_TO_DATE</span><span class="p">(</span><span class="s1">&#39;1997-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">);</span><span class="o">#</span><span class="w"> </span><span class="err">显式转换操作，解析：字符串</span><span class="w"> </span><span class="c1">----&gt; 日期
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询公司中入职超过</span><span class="mi">10000</span><span class="err">天的员工姓名、入职时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span><span class="n">hire_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">CURDATE</span><span class="p">(),</span><span class="n">hire_date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">做一个查询，产生下面的结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="o">&lt;</span><span class="n">last_name</span><span class="o">&gt;</span><span class="w"> </span><span class="n">earns</span><span class="w"> </span><span class="o">&lt;</span><span class="n">salary</span><span class="o">&gt;</span><span class="w"> </span><span class="n">monthly</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">wants</span><span class="w"> </span><span class="o">&lt;</span><span class="n">salary</span><span class="o">*</span><span class="mi">3</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="n">last_name</span><span class="p">,</span><span class="s1">&#39; earns &#39;</span><span class="p">,</span><span class="k">TRUNCATE</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; monthly but wants &#39;</span><span class="p">,</span><span class="k">TRUNCATE</span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="s2">&#34;Dream Salary&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">使用</span><span class="k">case</span><span class="o">-</span><span class="k">when</span><span class="err">，按照下面的条件：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*job                  grade
</span></span></span><span class="line"><span class="cl"><span class="cm">AD_PRES              	A
</span></span></span><span class="line"><span class="cl"><span class="cm">ST_MAN               	B
</span></span></span><span class="line"><span class="cl"><span class="cm">IT_PROG              	C
</span></span></span><span class="line"><span class="cl"><span class="cm">SA_REP               	D
</span></span></span><span class="line"><span class="cl"><span class="cm">ST_CLERK             	E
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">产生下面的结果:
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="w"> </span><span class="s2">&#34;Last_name&#34;</span><span class="p">,</span><span class="n">job_id</span><span class="w"> </span><span class="s2">&#34;Job_id&#34;</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="n">job_id</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;AD_PRES&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;ST_MAN&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;IT_PROG&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;SA_REP&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;ST_CLERK&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;Grade&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">last_name</span><span class="w"> </span><span class="s2">&#34;Last_name&#34;</span><span class="p">,</span><span class="n">job_id</span><span class="w"> </span><span class="s2">&#34;Job_id&#34;</span><span class="p">,</span><span class="k">CASE</span><span class="w"> </span><span class="n">job_id</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;AD_PRES&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;ST_MAN&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;IT_PROG&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;SA_REP&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;ST_CLERK&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							 </span><span class="k">ELSE</span><span class="w"> </span><span class="s2">&#34;undefined&#34;</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="s2">&#34;Grade&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h1 id="第8章-聚合函数">第8章 聚合函数</h1>
<blockquote>
<p>我们上一章讲到了 SQL 单行函数。实际上 SQL 函数还有一类，叫做聚合(或聚集、分组)函数，它是对一组数据进行汇总的函数，输入的是一组数据的集合，输出的是单个值。</p>
</blockquote>
<h2 id="81-聚合函数介绍">8.1 聚合函数介绍</h2>
<p><strong>什么是聚合函数</strong></p>
<blockquote>
<p>聚合函数作用于一组数据，并对一组数据返回一个值。</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556060.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556060.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556060.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556060.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556060.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p>聚合函数类型</p>
<ul>
<li>AVG()</li>
<li>SUM()</li>
<li>MAX()</li>
<li>MIN()</li>
<li>COUNT()</li>
</ul>
</blockquote>
<p><strong>聚合函数语法</strong>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./8cf4ce1335294f3e89830843cebec5d5.png"
        data-srcset="./8cf4ce1335294f3e89830843cebec5d5.png, ./8cf4ce1335294f3e89830843cebec5d5.png 1.5x, ./8cf4ce1335294f3e89830843cebec5d5.png 2x"
        data-sizes="auto"
        alt="./8cf4ce1335294f3e89830843cebec5d5.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p>聚合函数不能嵌套调用。比如不能出现类似“AVG(SUM(字段名称))”形式的调用</p>
</blockquote>
<h2 id="4-avg和sum函数">4 AVG和SUM函数</h2>
<blockquote>
<p>可以对数值型数据使用AVG 和 SUM 函数。</p>
</blockquote>
<pre><code>SELECT AVG(salary), MAX(salary),MIN(salary), SUM(salary)
FROM   employees
WHERE  job_id LIKE '%REP%';
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./e038b03aa47b48f4a73e99dee47ffb03.png"
        data-srcset="./e038b03aa47b48f4a73e99dee47ffb03.png, ./e038b03aa47b48f4a73e99dee47ffb03.png 1.5x, ./e038b03aa47b48f4a73e99dee47ffb03.png 2x"
        data-sizes="auto"
        alt="./e038b03aa47b48f4a73e99dee47ffb03.png"
        title="在这里插入图片描述" /></p>
<h3 id="41-min和max函数">4.1 MIN和MAX函数</h3>
<blockquote>
<p>可以对任意数据类型的数据使用 MIN 和 MAX 函数。</p>
</blockquote>
<pre><code>SELECT MIN(hire_date), MAX(hire_date)
FROM	  employees;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./9d531268b9ef4bdba62be63324702fa7.png"
        data-srcset="./9d531268b9ef4bdba62be63324702fa7.png, ./9d531268b9ef4bdba62be63324702fa7.png 1.5x, ./9d531268b9ef4bdba62be63324702fa7.png 2x"
        data-sizes="auto"
        alt="./9d531268b9ef4bdba62be63324702fa7.png"
        title="加粗样式" /></p>
<h3 id="42-count函数">4.2 COUNT函数</h3>
<blockquote>
<p>COUNT(*)返回表中记录总数，适用于任意数据类型。</p>
</blockquote>
<pre><code>SELECT COUNT(*)
FROM	  employees
WHERE  department_id = 50;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./99e4f68662ba48588896f45c4f0b2abe.png"
        data-srcset="./99e4f68662ba48588896f45c4f0b2abe.png, ./99e4f68662ba48588896f45c4f0b2abe.png 1.5x, ./99e4f68662ba48588896f45c4f0b2abe.png 2x"
        data-sizes="auto"
        alt="./99e4f68662ba48588896f45c4f0b2abe.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p>COUNT(expr) 返回expr不为空的记录总数。</p>
</blockquote>
<pre><code>SELECT COUNT(commission_pct)
FROM   employees
WHERE  department_id = 50;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./e3c0b433da8246d1b8aa22bea67442ab.png"
        data-srcset="./e3c0b433da8246d1b8aa22bea67442ab.png, ./e3c0b433da8246d1b8aa22bea67442ab.png 1.5x, ./e3c0b433da8246d1b8aa22bea67442ab.png 2x"
        data-sizes="auto"
        alt="./e3c0b433da8246d1b8aa22bea67442ab.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p>问题：用count(*)，count(1)，count(列名)谁好呢?</p>
<ul>
<li>其实，对于MyISAM引擎的表是没有区别的。这种引擎内部有一计数器在维护着行数。</li>
<li>Innodb引擎的表用count(*),count(1)直接读行数，复杂度是O(n)，因为innodb真的要去数一遍。但好于具体的count(列名)。</li>
</ul>
</blockquote>
<blockquote>
<p>问题：能不能使用count(列名)替换count(*)?</p>
<ul>
<li>不要使用 count(列名)来替代 count(<em>)，count(</em>)是 SQL92 定义的标准统计行数的语法，跟数据库无关，跟 NULL 和非 NULL 无关。</li>
<li>说明：count(*)会统计值为 NULL 的行，而 count(列名)不会统计此列为 NULL 值的行。</li>
</ul>
</blockquote>
<h2 id="82-group-by">8.2 GROUP BY</h2>
<h3 id="43-基本使用">4.3 基本使用</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556116.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556116.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556116.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556116.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556116.png"
        title="在这里插入图片描述" />
<strong>可以使用GROUP BY子句将表中的数据分成若干组</strong></p>
<pre><code>SELECT column, group_function(column)
FROM table
[WHERE	condition]
[GROUP BY	group_by_expression]
[ORDER BY	column];
</code></pre>
<p><strong>在SELECT列表中所有未包含在组函数中的列都应该包含在 GROUP BY子句中</strong></p>
<pre><code>SELECT   department_id, AVG(salary)
FROM     employees
GROUP BY department_id ;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556127.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556127.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556127.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556127.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556127.png"
        title="在这里插入图片描述" />
包含在 GROUP BY 子句中的列不必包含在SELECT 列表中</p>
<pre><code>SELECT   AVG(salary)
FROM     employees
GROUP BY department_id ;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556119.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556119.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556119.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556119.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556119.png"
        title="在这里插入图片描述" /></p>
<h3 id="44-使用多个列分组">4.4 使用多个列分组</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556124.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556124.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556124.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556124.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556124.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT   department_id dept_id, job_id, SUM(salary)
FROM     employees
GROUP BY department_id, job_id ;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556123.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556123.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556123.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556123.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556123.png"
        title="在这里插入图片描述" /></p>
<h3 id="45-group-by中使用with-rollup">4.5 GROUP BY中使用WITH ROLLUP</h3>
<blockquote>
<p>使用<code>WITH ROLLUP</code>关键字之后，在所有查询出的分组记录之后增加一条记录，该记录计算查询出的所有记录的总和，即统计记录数量。</p>
</blockquote>
<pre><code>SELECT department_id,AVG(salary)
FROM employees
WHERE department_id &gt; 80
GROUP BY department_id WITH ROLLUP;
</code></pre>
<blockquote>
<p>注意：<code>当使用ROLLUP时，不能同时使用ORDER BY子句进行结果排序，即ROLLUP和ORDER BY是互相排斥的。</code></p>
</blockquote>
<h2 id="83-having">8.3 HAVING</h2>
<h3 id="46-基本使用">4.6 基本使用</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556174.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556174.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556174.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_20%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16-20220523012556174.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_20,color_FFFFFF,t_70,g_se,x_16-20220523012556174.png"
        title="在这里插入图片描述" /></p>
<blockquote>
<p><strong>过滤分组：HAVING子句</strong></p>
<ul>
<li>行已经被分组。</li>
<li>使用了聚合函数。</li>
<li>满足HAVING 子句中条件的分组将被显示。</li>
<li>HAVING 不能单独使用，必须要跟 GROUP BY 一起使用。</li>
</ul>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./6271b1902934467682d298e36cc5349d.png"
        data-srcset="./6271b1902934467682d298e36cc5349d.png, ./6271b1902934467682d298e36cc5349d.png 1.5x, ./6271b1902934467682d298e36cc5349d.png 2x"
        data-sizes="auto"
        alt="./6271b1902934467682d298e36cc5349d.png"
        title="在这里插入图片描述" /></p>
<pre><code>SELECT   department_id, MAX(salary)
FROM     employees
GROUP BY department_id
HAVING   MAX(salary)&gt;10000 ;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./0d123255ae6d44a8ba9d0a15c65db120.png"
        data-srcset="./0d123255ae6d44a8ba9d0a15c65db120.png, ./0d123255ae6d44a8ba9d0a15c65db120.png 1.5x, ./0d123255ae6d44a8ba9d0a15c65db120.png 2x"
        data-sizes="auto"
        alt="./0d123255ae6d44a8ba9d0a15c65db120.png"
        title="在这里插入图片描述" />
**非法使用聚合函数 ： 不能在 WHERE 子句中使用聚合函数。**如下：</p>
<pre><code>SELECT   department_id, AVG(salary)
FROM     employees
WHERE    AVG(salary) &gt; 8000
GROUP BY department_id;
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./95ba2a259f144edba92d22c9feb465fc.png"
        data-srcset="./95ba2a259f144edba92d22c9feb465fc.png, ./95ba2a259f144edba92d22c9feb465fc.png 1.5x, ./95ba2a259f144edba92d22c9feb465fc.png 2x"
        data-sizes="auto"
        alt="./95ba2a259f144edba92d22c9feb465fc.png"
        title="在这里插入图片描述" /></p>
<h3 id="47-where和having的对比">4.7 WHERE和HAVING的对比</h3>
<blockquote>
<p><strong>区别1：WHERE 可以直接使用表中的字段作为筛选条件，但不能使用分组中的计算函数作为筛选条件；HAVING 必须要与 GROUP BY 配合使用，可以把分组计算的函数和分组字段作为筛选条件。</strong></p>
</blockquote>
<blockquote>
<p>这决定了，在需要对数据进行分组统计的时候，HAVING 可以完成 WHERE 不能完成的任务。这是因为，在查询语法结构中，WHERE 在 GROUP BY 之前，所以无法对分组结果进行筛选。HAVING 在 GROUP BY 之后，可以使用分组字段和分组中的计算函数，对分组的结果集进行筛选，这个功能是 WHERE 无法完成的。另外，WHERE排除的记录不再包括在分组中。</p>
</blockquote>
<blockquote>
<p><strong>区别2：如果需要通过连接从关联表中获取需要的数据，WHERE 是先筛选后连接，而 HAVING 是先连接后筛选。</strong> 这一点，就决定了在关联查询中，WHERE 比 HAVING 更高效。因为 WHERE 可以先筛选，用一个筛选后的较小数据集和关联表进行连接，这样占用的资源比较少，执行效率也比较高。HAVING 则需要先把结果集准备好，也就是用未被筛选的数据集进行关联，然后对这个大的数据集进行筛选，这样占用的资源就比较多，执行效率也较低。</p>
</blockquote>
<p>小结如下：</p>
<p>优点</p>
<p>缺点</p>
<p>WHERE</p>
<p>先筛选数据再关联，执行效率高 不能使用分组中的计算函数进行筛选</p>
<p>HAVING</p>
<p>可以使用分组中的计算函数 在最后的结果集中进行筛选，执行效率较低</p>
<p><strong>开发中的选择：</strong></p>
<blockquote>
<p>WHERE 和 HAVING 也不是互相排斥的，我们可以在一个查询里面同时使用 WHERE 和 HAVING。包含分组统计函数的条件用 HAVING，普通条件用 WHERE。这样，我们就既利用了 WHERE 条件的高效快速，又发挥了 HAVING 可以使用包含分组统计函数的查询条件的优点。当数据量特别大的时候，运行效率会有很大的差别。</p>
</blockquote>
<h2 id="84-select的执行过程">8.4 SELECT的执行过程</h2>
<h3 id="48-查询的结构">4.8 查询的结构</h3>
<h1 id="方式1">方式1：</h1>
<pre><code>SELECT ...,....,...
FROM ...,...,....
WHERE 多表的连接条件
AND 不包含组函数的过滤条件
GROUP BY ...,...
HAVING 包含组函数的过滤条件
ORDER BY ... ASC/DESC
LIMIT ...,...
</code></pre>
<h1 id="方式2">方式2：</h1>
<pre><code>SELECT ...,....,...
FROM ... JOIN ...
ON 多表的连接条件
JOIN ...
ON ...
WHERE 不包含组函数的过滤条件
AND/OR 不包含组函数的过滤条件
GROUP BY ...,...
HAVING 包含组函数的过滤条件
ORDER BY ... ASC/DESC
LIMIT ...,...
</code></pre>
<h1 id="其中">其中：</h1>
<h1 id="1from从哪些表中筛选">(1)from：从哪些表中筛选</h1>
<h1 id="2on关联多表查询时去除笛卡尔积">(2)on：关联多表查询时，去除笛卡尔积</h1>
<h1 id="3where从表中筛选的条件">(3)where：从表中筛选的条件</h1>
<h1 id="4group-by分组依据">(4)group by：分组依据</h1>
<h1 id="5having在统计结果中再次筛选">(5)having：在统计结果中再次筛选</h1>
<h1 id="6order-by排序">(6)order by：排序</h1>
<h1 id="7limit分页">(7)limit：分页</h1>
<h2 id="5-select执行顺序">5 SELECT执行顺序</h2>
<p>你需要记住 SELECT 查询时的两个顺序：</p>
<p><strong>关键字的顺序是不能颠倒的：</strong></p>
<pre><code>SELECT ... FROM ... WHERE ... GROUP BY ... HAVING ... ORDER BY ... LIMIT...
</code></pre>
<p><strong>SELECT 语句的执行顺序(在 MySQL 和 Oracle 中，SELECT 执行顺序基本相同)：</strong></p>
<pre><code>FROM -&gt; WHERE -&gt; GROUP BY -&gt; HAVING -&gt; SELECT 的字段 -&gt; DISTINCT -&gt; ORDER BY -&gt; LIMIT
</code></pre>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_17,color_FFFFFF,t_70,g_se,x_16.png"
        data-srcset="./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_17%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16.png, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_17%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16.png 1.5x, ./watermark%2ctype_d3F5LXplbmhlaQ%2cshadow_50%2ctext_Q1NETiBA6Zmz6aiw6aOb%2csize_17%2ccolor_FFFFFF%2ct_70%2cg_se%2cx_16.png 2x"
        data-sizes="auto"
        alt="./watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zmz6aiw6aOb,size_17,color_FFFFFF,t_70,g_se,x_16.png"
        title="在这里插入图片描述" />
比如你写了一个 SQL 语句，那么它的关键字顺序和执行顺序是下面这样的：</p>
<pre><code>SELECT DISTINCT player_id, player_name, count(*) as num # 顺序 5
FROM player JOIN team ON player.team_id = team.team_id # 顺序 1
WHERE height &gt; 1.80 # 顺序 2
GROUP BY player.team_id # 顺序 3
HAVING num &gt; 2 # 顺序 4
ORDER BY num DESC # 顺序 6
LIMIT 2 # 顺序 7
</code></pre>
<blockquote>
<p>在 SELECT 语句执行这些步骤的时候，每个步骤都会产生一个虚拟表，然后将这个虚拟表传入下一个步骤中作为输入。需要注意的是，这些步骤隐含在 SQL 的执行过程中，对于我们来说是不可见的。</p>
</blockquote>
<h3 id="51-sql-的执行原理">5.1 SQL 的执行原理</h3>
<blockquote>
<ul>
<li>SELECT 是先执行 FROM 这一步的。在这个阶段，如果是多张表联查，还会经历下面的几个步骤：
<ul>
<li>首先先通过 CROSS JOIN 求笛卡尔积，相当于得到虚拟表 vt(virtual table)1-1；</li>
<li>通过 ON 进行筛选，在虚拟表 vt1-1 的基础上进行筛选，得到虚拟表 vt1-2；</li>
<li>添加外部行。如果我们使用的是左连接、右链接或者全连接，就会涉及到外部行，也就是在虚拟表 vt1-2 的基础上增加外部行，得到虚拟表 vt1-3。</li>
</ul>
</li>
<li>当然如果我们操作的是两张以上的表，还会重复上面的步骤，直到所有表都被处理完为止。这个过程得到是我们的原始数据。</li>
<li>当我们拿到了查询数据表的原始数据，也就是最终的虚拟表 vt1，就可以在此基础上再进行 WHERE 阶段。在这个阶段中，会根据 vt1 表的结果进行筛选过滤，得到虚拟表 vt2。</li>
<li>然后进入第三步和第四步，也就是 GROUP 和 HAVING 阶段。在这个阶段中，实际上是在虚拟表 vt2 的基础上进行分组和分组过滤，得到中间的虚拟表 vt3 和 vt4。</li>
<li>当我们完成了条件筛选部分之后，就可以筛选表中提取的字段，也就是进入到 SELECT 和 DISTINCT 阶段。</li>
<li>首先在 SELECT 阶段会提取想要的字段，然后在 DISTINCT 阶段过滤掉重复的行，分别得到中间的虚拟表 vt5-1 和 vt5-2。</li>
<li>当我们提取了想要的字段数据之后，就可以按照指定的字段进行排序，也就是 ORDER BY 阶段，得到虚拟表 vt6。</li>
<li>最后在 vt6 的基础上，取出指定行的记录，也就是 LIMIT 阶段，得到最终的结果，对应的是虚拟表 vt7。</li>
<li>当然我们在写 SELECT 语句的时候，不一定存在所有的关键字，相应的阶段就会省略。</li>
<li>同时因为 SQL 是一门类似英语的结构化查询语言，所以我们在写 SELECT 语句的时候，还要注意相应的关键字顺序，*<em>所谓底层运行的原理，就是我们刚才讲到的执行顺序。</em></li>
</ul>
<h2 id="84-练习sql">8.4. 练习sql</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="err">第</span><span class="mi">08</span><span class="err">章</span><span class="n">_</span><span class="err">聚合函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="err">常见的几个聚合函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="k">AVG</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">SUM</span><span class="w"> </span><span class="err">：只适用于数值类型的字段</span><span class="p">(</span><span class="err">或变量</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">107</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">如下的操作没有意义</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">last_name</span><span class="p">),</span><span class="k">AVG</span><span class="p">(</span><span class="n">last_name</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">hire_date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="k">MAX</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">MIN</span><span class="w"> </span><span class="p">:</span><span class="err">适用于数值类型、字符串类型、日期时间类型的字段</span><span class="p">(</span><span class="err">或变量</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">last_name</span><span class="p">),</span><span class="k">MIN</span><span class="p">(</span><span class="n">last_name</span><span class="p">),</span><span class="k">MAX</span><span class="p">(</span><span class="n">hire_date</span><span class="p">),</span><span class="k">MIN</span><span class="p">(</span><span class="n">hire_date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="k">COUNT</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">①</span><span class="w"> </span><span class="err">作用：计算指定字段在查询结构中出现的个数</span><span class="p">(</span><span class="err">不包含</span><span class="n">NULL</span><span class="err">值的</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">employee_id</span><span class="p">),</span><span class="k">COUNT</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">COUNT</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">salary</span><span class="p">),</span><span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="k">COUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">如果计算表中有多少条记录，如何实现？</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">1</span><span class="err">：</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">2</span><span class="err">：</span><span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">3</span><span class="err">：</span><span class="k">COUNT</span><span class="p">(</span><span class="err">具体字段</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">不一定对！</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">②</span><span class="w"> </span><span class="err">注意：计算指定字段出现的个数时，是不计算</span><span class="n">NULL</span><span class="err">值的。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">commission_pct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">commission_pct</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">③</span><span class="w"> </span><span class="err">公式：</span><span class="k">AVG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SUM</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">COUNT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="o">/</span><span class="k">COUNT</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AVG</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">)</span><span class="o">/</span><span class="k">COUNT</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SUM</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">107</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">需求：查询公司中平均奖金率</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">错误的！</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">正确的：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">IFNULL</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AVG</span><span class="p">(</span><span class="n">IFNULL</span><span class="p">(</span><span class="n">commission_pct</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">如何需要统计表中的记录数，使用</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="err">、</span><span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">、</span><span class="k">COUNT</span><span class="p">(</span><span class="err">具体字段</span><span class="p">)</span><span class="w"> </span><span class="err">哪个效率更高呢？</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">如果使用的是</span><span class="n">MyISAM</span><span class="w"> </span><span class="err">存储引擎，则三者效率相同，都是</span><span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">如果使用的是</span><span class="n">InnoDB</span><span class="w"> </span><span class="err">存储引擎，则三者效率：</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="err">字段</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">其他：方差、标准差、中位数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">的使用</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">需求：查询各个部门的平均工资，最高工资</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">需求：查询各个</span><span class="n">job_id</span><span class="err">的平均工资</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">job_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">job_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">需求：查询各个</span><span class="n">department_id</span><span class="p">,</span><span class="n">job_id</span><span class="err">的平均工资</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">1</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="n">job_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">  </span><span class="n">department_id</span><span class="p">,</span><span class="n">job_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">2</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">job_id</span><span class="p">,</span><span class="n">department_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">job_id</span><span class="p">,</span><span class="n">department_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">错误的！</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="n">job_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">结论</span><span class="mi">1</span><span class="err">：</span><span class="n">SELECT</span><span class="err">中出现的非组函数的字段必须声明在</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">中。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w">      </span><span class="err">反之，</span><span class="k">GROUP</span><span class="w"> </span><span class="n">BY</span><span class="err">中声明的字段可以不出现在</span><span class="n">SELECT</span><span class="err">中。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">结论</span><span class="mi">2</span><span class="err">：</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">声明在</span><span class="n">FROM</span><span class="err">后面、</span><span class="n">WHERE</span><span class="err">后面，</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">前面、</span><span class="n">LIMIT</span><span class="err">前面</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">结论</span><span class="mi">3</span><span class="err">：</span><span class="n">MySQL</span><span class="err">中</span><span class="k">GROUP</span><span class="w"> </span><span class="n">BY</span><span class="err">中使用</span><span class="k">WITH</span><span class="w"> </span><span class="k">ROLLUP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">ROLLUP</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">需求：查询各个部门的平均工资，按照平均工资升序排列</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">avg_sal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">avg_sal</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">说明：当使用</span><span class="n">ROLLUP</span><span class="err">时，不能同时使用</span><span class="k">ORDER</span><span class="w"> </span><span class="n">BY</span><span class="err">子句进行结果排序，即</span><span class="n">ROLLUP</span><span class="err">和</span><span class="k">ORDER</span><span class="w"> </span><span class="n">BY</span><span class="err">是互相排斥的。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">错误的：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">avg_sal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">ROLLUP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">avg_sal</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="n">HAVING</span><span class="err">的使用</span><span class="w"> </span><span class="p">(</span><span class="err">作用：用来过滤数据的</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">练习：查询各个部门中最高工资比</span><span class="mi">10000</span><span class="err">高的部门信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">错误的写法：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">要求</span><span class="mi">1</span><span class="err">：如果过滤条件中使用了聚合函数，则必须使用</span><span class="n">HAVING</span><span class="err">来替换</span><span class="k">WHERE</span><span class="err">。否则，报错。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">要求</span><span class="mi">2</span><span class="err">：</span><span class="k">HAVING</span><span class="w"> </span><span class="err">必须声明在</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">的后面。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">正确的写法：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">要求</span><span class="mi">3</span><span class="err">：开发中，我们使用</span><span class="n">HAVING</span><span class="err">的前提是</span><span class="n">SQL</span><span class="err">中使用了</span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="err">。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">练习：查询部门</span><span class="n">id</span><span class="err">为</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="err">这</span><span class="mi">4</span><span class="err">个部门中最高工资比</span><span class="mi">10000</span><span class="err">高的部门信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">1</span><span class="err">：推荐，执行效率高于方式</span><span class="mi">2</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">方式</span><span class="mi">2</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">department_id</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">department_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="err">结论：当过滤条件中有聚合函数时，则此过滤条件必须声明在</span><span class="n">HAVING</span><span class="err">中。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w">      </span><span class="err">当过滤条件中没有聚合函数时，则此过滤条件声明在</span><span class="n">WHERE</span><span class="err">中或</span><span class="n">HAVING</span><span class="err">中都可以。但是，建议大家声明在</span><span class="n">WHERE</span><span class="err">中。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">  WHERE 与 HAVING 的对比
</span></span></span><span class="line"><span class="cl"><span class="cm">1. 从适用范围上来讲，HAVING的适用范围更广。
</span></span></span><span class="line"><span class="cl"><span class="cm">2. 如果过滤条件中没有聚合函数：这种情况下，WHERE的执行效率要高于HAVING
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="n">SQL</span><span class="err">底层执行原理</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">4</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">语句的完整结构</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">#sql92语法：
</span></span></span><span class="line"><span class="cl"><span class="cm">SELECT ....,....,....(存在聚合函数)
</span></span></span><span class="line"><span class="cl"><span class="cm">FROM ...,....,....
</span></span></span><span class="line"><span class="cl"><span class="cm">WHERE 多表的连接条件 AND 不包含聚合函数的过滤条件
</span></span></span><span class="line"><span class="cl"><span class="cm">GROUP BY ...,....
</span></span></span><span class="line"><span class="cl"><span class="cm">HAVING 包含聚合函数的过滤条件
</span></span></span><span class="line"><span class="cl"><span class="cm">ORDER BY ....,...(ASC / DESC )
</span></span></span><span class="line"><span class="cl"><span class="cm">LIMIT ...,....
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">#sql99语法：
</span></span></span><span class="line"><span class="cl"><span class="cm">SELECT ....,....,....(存在聚合函数)
</span></span></span><span class="line"><span class="cl"><span class="cm">FROM ... (LEFT / RIGHT)JOIN ....ON 多表的连接条件
</span></span></span><span class="line"><span class="cl"><span class="cm">(LEFT / RIGHT)JOIN ... ON ....
</span></span></span><span class="line"><span class="cl"><span class="cm">WHERE 不包含聚合函数的过滤条件
</span></span></span><span class="line"><span class="cl"><span class="cm">GROUP BY ...,....
</span></span></span><span class="line"><span class="cl"><span class="cm">HAVING 包含聚合函数的过滤条件
</span></span></span><span class="line"><span class="cl"><span class="cm">ORDER BY ....,...(ASC / DESC )
</span></span></span><span class="line"><span class="cl"><span class="cm">LIMIT ...,....
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="n">SQL</span><span class="err">语句的执行过程：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="k">FROM</span><span class="w"> </span><span class="p">...,...</span><span class="o">-&gt;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">LEFT</span><span class="o">/</span><span class="n">RIGNT</span><span class="w">  </span><span class="k">JOIN</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">HAVING</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">LIMIT</span><span class="w">
</span></span></span></code></pre></div></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">第</span><span class="mi">08</span><span class="err">章</span><span class="n">_</span><span class="err">聚合函数的课后练习</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">where</span><span class="err">子句可否使用组函数进行过滤</span><span class="o">?</span><span class="w">  </span><span class="k">No</span><span class="o">!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询公司员工工资的最大值，最小值，平均值，总和</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">max_sal</span><span class="w"> </span><span class="p">,</span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">mim_sal</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">avg_sal</span><span class="p">,</span><span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="n">sum_sal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询各</span><span class="n">job_id</span><span class="err">的员工工资的最大值，最小值，平均值，总和</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">job_id</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">),</span><span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">job_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">选择具有各个</span><span class="n">job_id</span><span class="err">的员工人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">job_id</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">job_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询员工最高工资和最低工资的差距</span><span class="p">(</span><span class="n">DIFFERENCE</span><span class="p">)</span><span class="w">  </span><span class="n">DATEDIFF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;DIFFERENCE&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询各个管理者手下员工的最低工资，其中最低工资不能低于</span><span class="mi">6000</span><span class="err">，没有管理者的员工不计算在内</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">manager_id</span><span class="p">,</span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">manager_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">manager_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">6000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询所有部门的名字，</span><span class="n">location_id</span><span class="err">，员工数量和平均工资，并按平均工资降序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">department_name</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="n">employee_id</span><span class="p">),</span><span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">departments</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="o">`</span><span class="n">department_id</span><span class="o">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="o">`</span><span class="n">department_id</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_name</span><span class="p">,</span><span class="n">location_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">查询每个工种、每个部门的部门名、工种名和最低工资</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">department_name</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">job_id</span><span class="p">,</span><span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">departments</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="o">`</span><span class="n">department_id</span><span class="o">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="o">`</span><span class="n">department_id</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">department_name</span><span class="p">,</span><span class="n">job_id</span><span class="w">
</span></span></span></code></pre></div></div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/database/">database</a>
                </span><span><a href="/tags/mysql/">mysql</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>更新于 2022-06-17</span>
            </div><div class="post-info-mod"></div>
        </div></div><div class="post-nav"><a href="/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B09-10%E7%AB%A0/" class="prev" rel="prev" title="mysql详细笔记9-10章"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/database%E6%9C%AA%E5%A4%84%E7%90%86/mysql/mysql%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B05-6%E7%AB%A0/" class="next" rel="next" title="mysql详细笔记5-6章">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.112.4">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.zh.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body></html>
